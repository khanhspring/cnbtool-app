(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{qvXC:function(e,t,n){"use strict";n.r(t),n.d(t,"SalaryModule",(function(){return Jn}));var i=n("ofXK"),o=n("tyNb"),c=n("fXoL");let s=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Nb({type:e,selectors:[["app-salary"]],decls:1,vars:0,template:function(e,t){1&e&&c.Ub(0,"router-outlet")},directives:[o.g],styles:[""]}),e})();var r=n("3Pt+"),a=n("wd/R");class l{}var b=n("AytR");class p{}var d=n("oXNa");class h{}class u{}var m=n("PScX"),z=n("dEAy"),f=n("jPNr"),g=n("OzZK"),y=n("FwiY"),C=n("0lU3"),Y=n("ocnv"),I=n("z4wI"),v=n("ZyQt"),Z=n("QlLE"),T=n("nJia"),k=n("rMZv"),w=n("D9mS"),A=n("W9fG"),S=n("tk/3");let F=(()=>{class e{constructor(e){this.http=e,this.API_URL=b.a.apiUrl+"/time-sheets"}getByMonth(e){return this.http.get(this.API_URL+`/${e}`)}create(e,t){return this.http.post(this.API_URL+`/${e}`,t)}update(e,t){return this.http.put(this.API_URL+`/${e}`,t)}statuses(e,t){return this.http.post(this.API_URL+`/${e}/statuses`,t)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(S.c))},e.\u0275prov=c.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M=n("lGQG"),O=n("RwU8"),D=n("C2AL"),q=n("B+r4"),P=n("mrSG"),U=n("2Suw"),E=n("XNiG"),_=n("JX91"),N=n("1G5W");const G=["*"],V={small:8,middle:16,large:24};let x=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t}setDirectionAndSize(e,t){const n="string"==typeof t?V[t]:t;"horizontal"===e?(this.renderer.removeStyle(this.elementRef.nativeElement,"margin-bottom"),this.renderer.setStyle(this.elementRef.nativeElement,"margin-right",`${n}px`)):(this.renderer.removeStyle(this.elementRef.nativeElement,"margin-right"),this.renderer.setStyle(this.elementRef.nativeElement,"margin-bottom",`${n}px`))}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(c.E),c.Tb(c.l))},e.\u0275cmp=c.Nb({type:e,selectors:[["nz-space-item"],["","nz-space-item",""]],hostAttrs:[1,"ant-space-item"],ngContentSelectors:G,decls:1,vars:0,template:function(e,t){1&e&&(c.pc(),c.oc(0))},encapsulation:2,changeDetection:0}),e})(),R=(()=>{class e{constructor(e){this.nzConfigService=e,this.nzDirection="horizontal",this.destroy$=new E.a}updateSpaceItems(){this.nzSpaceItemComponents&&this.nzSpaceItemComponents.forEach(e=>{e.setDirectionAndSize(this.nzDirection,this.nzSize)})}ngOnChanges(){this.updateSpaceItems()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){this.nzSpaceItemComponents.changes.pipe(Object(_.a)(null),Object(N.a)(this.destroy$)).subscribe(()=>{this.updateSpaceItems()})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(U.a))},e.\u0275cmp=c.Nb({type:e,selectors:[["nz-space"]],contentQueries:function(e,t,n){var i;1&e&&c.Lb(n,x,!1),2&e&&c.xc(i=c.ic())&&(t.nzSpaceItemComponents=i)},hostAttrs:[1,"ant-space"],hostVars:4,hostBindings:function(e,t){2&e&&c.Jb("ant-space-horizontal","horizontal"===t.nzDirection)("ant-space-vertical","vertical"===t.nzDirection)},inputs:{nzDirection:"nzDirection",nzSize:"nzSize"},exportAs:["NzSpace"],features:[c.Ab],ngContentSelectors:G,decls:1,vars:0,template:function(e,t){1&e&&(c.pc(),c.oc(0))},encapsulation:2,changeDetection:0}),Object(P.a)([Object(U.b)("avatar","small"),Object(P.b)("design:type",Object)],e.prototype,"nzSize",void 0),e})(),B=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})();function L(e,t){1&e&&(c.Zb(0,"nz-tag",17),c.Ic(1,"Approved"),c.Yb()),2&e&&c.qc("nzColor","#87d068")}function $(e,t){if(1&e&&(c.Zb(0,"span"),c.Ic(1,"Have no timesheet for "),c.Zb(2,"nz-tag"),c.Ic(3),c.lc(4,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.Jc(c.nc(4,1,e.date,"MM/yyyy"))}}function H(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",21),c.hc("click",(function(){return c.zc(e),c.kc(2).onCreate()})),c.Ic(1,"Create Now"),c.Yb()}if(2&e){const e=c.kc(2);c.qc("disabled",!e.date)}}function J(e,t){if(1&e&&(c.Zb(0,"nz-empty",18),c.Gc(1,$,5,4,"ng-template",null,19,c.Hc),c.Gc(3,H,2,1,"ng-template",null,20,c.Hc),c.Yb()),2&e){const e=c.yc(2),t=c.yc(4);c.qc("nzNotFoundContent",e)("nzNotFoundFooter",t)}}function W(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",34),c.hc("click",(function(){return c.zc(e),c.kc(2).onUpdateStandardWorkingHours()})),c.Ub(1,"i",35),c.Yb()}}function j(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",7),c.hc("click",(function(){return c.zc(e),c.kc(2).approve()})),c.Ub(2,"i",36),c.Ic(3," Approve"),c.Yb(),c.Yb()}}function X(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",37),c.hc("click",(function(){return c.zc(e),c.kc(2).unapproved()})),c.Ub(2,"i",38),c.Ic(3," Unapproved"),c.Yb(),c.Yb()}}function Q(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",39),c.hc("click",(function(){return c.zc(e),c.kc(2).save()})),c.Ub(2,"i",40),c.Yb(),c.Yb()}}function K(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"nz-upload",41),c.hc("nzChange",(function(t){return c.zc(e),c.kc(2).handleUpdateFileChange(t)})),c.Zb(2,"button",42),c.Ub(3,"i",43),c.Yb(),c.Yb(),c.Yb()}if(2&e){const e=c.kc(2);c.Cb(1),c.qc("nzAction",e.uploadAction)("nzShowUploadList",!1)}}function ee(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","workingHours_",e.employee.id,""),c.sc("id","workingHours_",e.employee.id,"")}}function te(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.workingHours)}}function ne(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","vacationHours_",e.employee.id,""),c.sc("id","vacationHours_",e.employee.id,"")}}function ie(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.vacationHours)}}function oe(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","bizTripDays_",e.employee.id,""),c.sc("id","bizTripDays_",e.employee.id,"")}}function ce(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.bizTripDays)}}function se(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","overTime100_",e.employee.id,""),c.sc("id","overTime100_",e.employee.id,"")}}function re(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.overTime100)}}function ae(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","overTime120_",e.employee.id,""),c.sc("id","overTime120_",e.employee.id,"")}}function le(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.overTime120)}}function be(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-form-control",15),c.Zb(1,"nz-input-number",48),c.hc("ngModelChange",(function(){return c.zc(e),c.kc(3).updateTimesheetData()})),c.Yb(),c.Yb()}if(2&e){const e=c.kc().$implicit;c.Cb(1),c.sc("formControlName","overTime150_",e.employee.id,""),c.sc("id","overTime150_",e.employee.id,"")}}function pe(e,t){if(1&e&&(c.Zb(0,"span",49),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(1),c.Jc(e.overTime150)}}function de(e,t){if(1&e&&(c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"a",44),c.Ic(3),c.Yb(),c.Yb(),c.Zb(4,"td"),c.Ic(5),c.Yb(),c.Zb(6,"td"),c.Ub(7,"nz-progress",45),c.lc(8,"number"),c.Yb(),c.Zb(9,"td"),c.Gc(10,ee,2,2,"nz-form-control",46),c.Gc(11,te,2,1,"span",47),c.Yb(),c.Zb(12,"td"),c.Gc(13,ne,2,2,"nz-form-control",46),c.Gc(14,ie,2,1,"span",47),c.Yb(),c.Zb(15,"td"),c.Gc(16,oe,2,2,"nz-form-control",46),c.Gc(17,ce,2,1,"span",47),c.Yb(),c.Zb(18,"td"),c.Gc(19,se,2,2,"nz-form-control",46),c.Gc(20,re,2,1,"span",47),c.Yb(),c.Zb(21,"td"),c.Gc(22,ae,2,2,"nz-form-control",46),c.Gc(23,le,2,1,"span",47),c.Yb(),c.Zb(24,"td"),c.Gc(25,be,2,2,"nz-form-control",46),c.Gc(26,pe,2,1,"span",47),c.Yb(),c.Yb()),2&e){const e=t.$implicit,n=c.kc(2);c.Cb(2),c.sc("routerLink","/employee/detail/",e.employee.id,""),c.Cb(1),c.Jc(e.employee.email),c.Cb(2),c.Jc(e.employee.fullName),c.Cb(2),c.qc("nzPercent",c.nc(8,16,100*e.workingHours/n.standardWorkingHours,"1.0-0")),c.Cb(3),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved),c.Cb(2),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved),c.Cb(2),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved),c.Cb(2),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved),c.Cb(2),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved),c.Cb(2),c.qc("ngIf",!n.isApproved),c.Cb(1),c.qc("ngIf",n.isApproved)}}function he(e,t){if(1&e&&(c.Zb(0,"div",22),c.Zb(1,"div",23),c.Zb(2,"div",24),c.Zb(3,"h1",25),c.Ic(4),c.Zb(5,"span"),c.Ic(6,"hours"),c.Yb(),c.Gc(7,W,2,0,"button",26),c.Yb(),c.Yb(),c.Zb(8,"div",27),c.Zb(9,"nz-space"),c.Gc(10,j,4,0,"nz-space-item",28),c.Gc(11,X,4,0,"nz-space-item",28),c.Gc(12,Q,3,0,"nz-space-item",28),c.Gc(13,K,4,2,"nz-space-item",28),c.Yb(),c.Yb(),c.Yb(),c.Zb(14,"div",29),c.Zb(15,"form",13),c.Zb(16,"nz-table",30,31),c.Zb(18,"thead"),c.Zb(19,"tr"),c.Zb(20,"th"),c.Ic(21,"Email"),c.Yb(),c.Zb(22,"th"),c.Ic(23,"Name"),c.Yb(),c.Zb(24,"th"),c.Ic(25,"Visualization"),c.Yb(),c.Zb(26,"th",32),c.Ic(27,"Working hours"),c.Yb(),c.Zb(28,"th",32),c.Ic(29,"Paid vacation hours"),c.Yb(),c.Zb(30,"th",32),c.Ic(31,"Biz trip (days)"),c.Yb(),c.Zb(32,"th",32),c.Ic(33,"OT 100% (hours)"),c.Yb(),c.Zb(34,"th",32),c.Ic(35,"OT 120% (hours)"),c.Yb(),c.Zb(36,"th",32),c.Ic(37,"OT 150% (hours)"),c.Yb(),c.Yb(),c.Yb(),c.Zb(38,"tbody"),c.Gc(39,de,27,19,"tr",33),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(17),t=c.kc();c.Cb(4),c.Kc("",t.standardWorkingHours," "),c.Cb(3),c.qc("ngIf",!t.isApproved),c.Cb(3),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",t.isApproved),c.Cb(1),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",!t.isApproved),c.Cb(2),c.qc("formGroup",t.timesheetForm),c.Cb(1),c.qc("nzData",t.listOfData)("nzShowPagination",!1)("nzFrontPagination",!1),c.Cb(23),c.qc("ngForOf",e.data)}}let ue=(()=>{class e{constructor(e,t,n,i,o,c){this.fb=e,this.route=t,this.message=n,this.modal=i,this.timeSheetService=o,this.authService=c,this.date=new Date,this.isModalVisible=!1,this.listOfData=[],this.isApproved=!1,this.isCreated=!1}ngOnInit(){this.createForm=this.fb.group({standardWorkingHours:[null,[r.o.required]]}),this.timesheetForm=this.fb.group({}),this.loadTimeSheet()}onMonthChange(e){this.date=e,this.loadTimeSheet()}onThisMonth(){this.date=new Date,this.loadTimeSheet()}onPrevMonth(){this.date=a(this.date).add(-1,"month").toDate(),this.loadTimeSheet()}onNextMonth(){this.date=a(this.date).add(1,"month").toDate(),this.loadTimeSheet()}onCreate(){this.isModalVisible=!0}onUpdateStandardWorkingHours(){this.createForm.get("standardWorkingHours").setValue(this.standardWorkingHours),this.isModalVisible=!0}handleCreateFormOk(){for(const e in this.createForm.controls)this.createForm.controls[e].markAsDirty(),this.createForm.controls[e].updateValueAndValidity();if(!this.createForm.invalid&&(this.isModalVisible=!1,this.standardWorkingHours=+this.createForm.get("standardWorkingHours").value,!this.isCreated)){const e=a(this.date).format("YYYY-MM"),t=new l;t.standardWorkingHours=this.standardWorkingHours,this.timeSheetService.create(e,t).subscribe(e=>{this.initTimesheetData(e),this.updateUploadData(),this.isCreated=!0},e=>{this.message.error("Couldn't create time sheet!")})}}handleCreateFormCancel(){this.isModalVisible=!1,this.createForm.reset()}initTimesheetData(e){this.listOfData=e.items,this.timesheetForm=this.fb.group({standardWorkingHours:[e.standardWorkingHours,[r.o.required]]}),e.items.forEach(e=>{this.timesheetForm.addControl("workingHours_"+e.employee.id,new r.d(e.workingHours,r.o.required)),this.timesheetForm.addControl("vacationHours_"+e.employee.id,new r.d(e.vacationHours,r.o.required)),this.timesheetForm.addControl("bizTripDays_"+e.employee.id,new r.d(e.bizTripDays,r.o.required)),this.timesheetForm.addControl("overTime100_"+e.employee.id,new r.d(e.overTime100,r.o.required)),this.timesheetForm.addControl("overTime120_"+e.employee.id,new r.d(e.overTime120,r.o.required)),this.timesheetForm.addControl("overTime150_"+e.employee.id,new r.d(e.overTime150,r.o.required))})}handleUpdateFileChange(e){"done"===e.file.status&&this.loadTimeSheet()}save(){const e=new h,t=a(this.date).format("YYYY-MM");e.items=this.toRequest(this.listOfData),this.timeSheetService.update(t,e).subscribe(e=>{this.message.info("Save successfully!"),this.loadTimeSheet()},e=>{this.message.error("Couldn't update time sheet!")})}approve(){this.modal.confirm({nzTitle:"Do you Want to approve this timesheet?",nzContent:"Once you approved, you can still edit it later",nzOnOk:()=>{const e=new u;e.status="APPROVED";const t=a(this.date).format("YYYY-MM");this.timeSheetService.statuses(t,e).subscribe(e=>{this.updateTimesheetData(),this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Approve unsuccessfully!")})}})}unapproved(){const e=a(this.date).format("YYYY-MM"),t=new u;t.status="UNAPPROVED",this.timeSheetService.statuses(e,t).subscribe(e=>{this.updateTimesheetData(),this.isApproved=!1,this.message.info("Unapproved successfully!")},e=>{this.message.error("Unapproved unsuccessfully!")})}updateTimesheetData(){for(const e of this.listOfData)e.workingHours=this.timesheetForm.get("workingHours_"+e.employee.id).value,e.vacationHours=this.timesheetForm.get("vacationHours_"+e.employee.id).value,e.bizTripDays=this.timesheetForm.get("bizTripDays_"+e.employee.id).value,e.overTime100=this.timesheetForm.get("overTime100_"+e.employee.id).value,e.overTime120=this.timesheetForm.get("overTime120_"+e.employee.id).value,e.overTime150=this.timesheetForm.get("overTime150_"+e.employee.id).value}loadTimeSheet(){const e=a(this.date).format("YYYY-MM");this.timeSheetService.getByMonth(e).subscribe(e=>{this.isCreated=!0,this.initTimesheetData(e),this.standardWorkingHours=e.standardWorkingHours,this.isApproved=e.status&&"APPROVED"===e.status,this.updateUploadData()},e=>{this.isCreated=!1,this.standardWorkingHours=void 0,this.isApproved=!1,this.listOfData=[]})}updateUploadData(){const e=a(this.date).format("YYYY-MM");this.uploadAction=b.a.apiUrl+`/time-sheets/${e}/importing`}toRequest(e){return e.map(e=>{const t=new p;return d.a.map(e,t),t})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(r.c),c.Tb(o.c),c.Tb(m.b),c.Tb(z.c),c.Tb(F),c.Tb(M.a))},e.\u0275cmp=c.Nb({type:e,selectors:[["app-timekeeping"]],decls:28,vars:16,consts:[[1,"wrap"],[1,"page-header"],["class","ml-1",3,"nzColor",4,"ngIf"],["nz-button","","nzType","primary","nzShape","circle",3,"click"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-icon","","nzType","arrow-right","nzTheme","outline"],["nzPlaceHolder","Select month",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],[1,"page-content"],[3,"nzNotFoundContent","nzNotFoundFooter",4,"ngIf"],["class","form-wrap",4,"ngIf"],[3,"nzVisible","nzTitle","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-form","",3,"formGroup"],["nzRequired","","nzFor","standardWorkingHours",3,"nzSm","nzXs"],["nzErrorTip","The input is required!"],["formControlName","standardWorkingHours","id","standardWorkingHours","nzPlaceHolder","Standard working hours",2,"width","100%"],[1,"ml-1",3,"nzColor"],[3,"nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["nz-button","","nzType","primary",3,"disabled","click"],[1,"form-wrap"],["nz-row","",1,"form-header"],["nz-col","","nzSpan","6"],["nz-tooltip","","nzTooltipTitle","Standard working hours"],["nz-button","","nzType","link","nzShape","circle","nzSize","small","class","ml-1",3,"click",4,"ngIf"],["nz-col","","nzSpan","18",1,"text-right"],[4,"ngIf"],[1,"form-content"],[1,"data-table",3,"nzData","nzShowPagination","nzFrontPagination"],["basicTable",""],["width","100px",1,"text-center"],[4,"ngFor","ngForOf"],["nz-button","","nzType","link","nzShape","circle","nzSize","small",1,"ml-1",3,"click"],["nz-icon","","nzType","edit"],["nz-icon","","nzType","check"],["nz-button","","nzType","default","nzDanger","","nzShape","round",3,"click"],["nz-icon","","nzType","stop"],["nz-button","","nzType","default","nzShape","circle","nz-tooltip","","nzTooltipTitle","Save",3,"click"],["nz-icon","","nzType","save"],[3,"nzAction","nzShowUploadList","nzChange"],["nz-button","","nzType","dashed","nzShape","circle","nz-tooltip","","nzTooltipTitle","Import"],["nz-icon","","nzType","upload"],[3,"routerLink"],["nzSize","small",3,"nzPercent"],["nzErrorTip","The input is required!",4,"ngIf"],["class","read-only-lbl",4,"ngIf"],["nzSize","small",2,"width","100%",3,"formControlName","id","ngModelChange"],[1,"read-only-lbl"]],template:function(e,t){1&e&&(c.Zb(0,"div",0),c.Zb(1,"nz-page-header",1),c.Zb(2,"nz-page-header-title"),c.Ic(3,"Timesheet"),c.Yb(),c.Zb(4,"nz-page-header-subtitle"),c.Ic(5),c.lc(6,"date"),c.Gc(7,L,2,1,"nz-tag",2),c.Yb(),c.Zb(8,"nz-page-header-extra"),c.Zb(9,"button",3),c.hc("click",(function(){return t.onPrevMonth()})),c.Ub(10,"i",4),c.Yb(),c.Zb(11,"button",3),c.hc("click",(function(){return t.onNextMonth()})),c.Ub(12,"i",5),c.Yb(),c.Zb(13,"nz-month-picker",6),c.hc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.onMonthChange(e)})),c.Yb(),c.Zb(14,"button",7),c.hc("click",(function(){return t.onThisMonth()})),c.Ub(15,"i",8),c.Ic(16,"This month "),c.Yb(),c.Yb(),c.Yb(),c.Zb(17,"div",9),c.Gc(18,J,5,2,"nz-empty",10),c.Gc(19,he,40,11,"div",11),c.Yb(),c.Yb(),c.Zb(20,"nz-modal",12),c.hc("nzVisibleChange",(function(e){return t.isModalVisible=e}))("nzOnCancel",(function(){return t.handleCreateFormCancel()}))("nzOnOk",(function(){return t.handleCreateFormOk()})),c.lc(21,"date"),c.Zb(22,"form",13),c.Zb(23,"nz-form-item"),c.Zb(24,"nz-form-label",14),c.Ic(25,"Standard working hours"),c.Yb(),c.Zb(26,"nz-form-control",15),c.Ub(27,"nz-input-number",16),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e&&(c.Cb(5),c.Kc("",c.nc(6,10,t.date,"MM/yyyy")," "),c.Cb(2),c.qc("ngIf",t.isApproved),c.Cb(6),c.qc("ngModel",t.date),c.Cb(5),c.qc("ngIf",!t.isCreated),c.Cb(1),c.qc("ngIf",t.isCreated),c.Cb(1),c.sc("nzTitle","Create new timesheet for ",c.nc(21,13,t.date,"MM/yyyy"),""),c.qc("nzVisible",t.isModalVisible),c.Cb(2),c.qc("formGroup",t.createForm),c.Cb(2),c.qc("nzSm",9)("nzXs",24))},directives:[f.a,f.e,f.d,i.m,f.b,g.a,O.a,D.a,y.b,C.a,C.c,r.k,r.m,z.a,r.p,r.l,Y.b,r.g,q.c,Y.c,q.a,Y.d,Y.a,I.a,r.f,v.a,Z.b,T.d,R,k.c,k.g,k.h,k.b,k.f,k.e,i.l,x,w.a,o.e,A.a],pipes:[i.e,i.f],styles:["nz-empty[_ngcontent-%COMP%]{margin-top:50px}.standard-working-hours[_ngcontent-%COMP%]{overflow:hidden;float:left;margin-bottom:10px;padding:20px;border:1px solid #f1f1f1}.form-content[_ngcontent-%COMP%]{width:100%;float:left}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700;float:left}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px!important;font-weight:400;color:#777}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:none}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{display:inline-block}.read-only-lbl[_ngcontent-%COMP%]{line-height:32px;padding-right:8px;text-align:right;display:block}"]}),e})();var me=function(e){return e.UTILITY_BILLS="UTILITY_BILLS",e.PERSONAL_TRAVEL_FEES="PERSONAL_TRAVEL_FEES",e.ADVANCES="ADVANCES",e.ARREARS="ARREARS",e.OTHER="OTHER",e}({}),ze=n("GR68"),fe=n("/KA4"),ge=n("pdGh");function ye(e,t){if(1&e&&(c.Xb(0),c.Ub(1,"i",6),c.Wb()),2&e){const e=c.kc(2);c.Cb(1),c.qc("nzType",e.nzIconType||e.inferredIconType)("nzTheme",e.iconTheme)}}function Ce(e,t){if(1&e&&(c.Xb(0),c.Ic(1),c.Wb()),2&e){const e=c.kc(3);c.Cb(1),c.Jc(e.nzMessage)}}function Ye(e,t){if(1&e&&(c.Zb(0,"span",7),c.Gc(1,Ce,2,1,"ng-container",8),c.Yb()),2&e){const e=c.kc(2);c.Cb(1),c.qc("nzStringTemplateOutlet",e.nzMessage)}}function Ie(e,t){if(1&e&&(c.Xb(0),c.Ic(1),c.Wb()),2&e){const e=c.kc(3);c.Cb(1),c.Jc(e.nzDescription)}}function ve(e,t){if(1&e&&(c.Zb(0,"span",9),c.Gc(1,Ie,2,1,"ng-container",8),c.Yb()),2&e){const e=c.kc(2);c.Cb(1),c.qc("nzStringTemplateOutlet",e.nzDescription)}}function Ze(e,t){1&e&&c.Ub(0,"i",13)}function Te(e,t){if(1&e&&(c.Xb(0),c.Zb(1,"span",14),c.Ic(2),c.Yb(),c.Wb()),2&e){const e=c.kc(4);c.Cb(2),c.Jc(e.nzCloseText)}}function ke(e,t){if(1&e&&(c.Xb(0),c.Gc(1,Te,3,1,"ng-container",8),c.Wb()),2&e){const e=c.kc(3);c.Cb(1),c.qc("nzStringTemplateOutlet",e.nzCloseText)}}function we(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",10),c.hc("click",(function(){return c.zc(e),c.kc(2).closeAlert()})),c.Gc(1,Ze,1,0,"ng-template",null,11,c.Hc),c.Gc(3,ke,2,1,"ng-container",12),c.Yb()}if(2&e){const e=c.yc(2),t=c.kc(2);c.Cb(3),c.qc("ngIf",t.nzCloseText)("ngIfElse",e)}}function Ae(e,t){if(1&e){const e=c.ac();c.Zb(0,"div",1),c.hc("@slideAlertMotion.done",(function(){return c.zc(e),c.kc().onFadeAnimationDone()})),c.Gc(1,ye,2,2,"ng-container",2),c.Gc(2,Ye,2,1,"span",3),c.Gc(3,ve,2,1,"span",4),c.Gc(4,we,4,2,"button",5),c.Yb()}if(2&e){const e=c.kc();c.Jb("ant-alert-success","success"===e.nzType)("ant-alert-info","info"===e.nzType)("ant-alert-warning","warning"===e.nzType)("ant-alert-error","error"===e.nzType)("ant-alert-no-icon",!e.nzShowIcon)("ant-alert-banner",e.nzBanner)("ant-alert-closable",e.nzCloseable)("ant-alert-with-description",!!e.nzDescription),c.qc("@slideAlertMotion",void 0),c.Cb(1),c.qc("ngIf",e.nzShowIcon),c.Cb(1),c.qc("ngIf",e.nzMessage),c.Cb(1),c.qc("ngIf",e.nzDescription),c.Cb(1),c.qc("ngIf",e.nzCloseable||e.nzCloseText)}}let Se=(()=>{class e{constructor(e,t){this.nzConfigService=e,this.cdr=t,this.nzCloseText=null,this.nzIconType=null,this.nzMessage=null,this.nzDescription=null,this.nzType="info",this.nzBanner=!1,this.nzOnClose=new c.n,this.closed=!1,this.iconTheme="fill",this.inferredIconType="info-circle",this.isTypeSet=!1,this.isShowIconSet=!1,this.destroy$=new E.a,this.nzConfigService.getConfigChangeEventForComponent("alert").pipe(Object(N.a)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}closeAlert(){this.closed=!0}onFadeAnimationDone(){this.closed&&this.nzOnClose.emit(!0)}ngOnChanges(e){const{nzShowIcon:t,nzDescription:n,nzType:i,nzBanner:o}=e;if(t&&(this.isShowIconSet=!0),i)switch(this.isTypeSet=!0,this.nzType){case"error":this.inferredIconType="close-circle";break;case"success":this.inferredIconType="check-circle";break;case"info":this.inferredIconType="info-circle";break;case"warning":this.inferredIconType="exclamation-circle"}n&&(this.iconTheme=this.nzDescription?"outline":"fill"),o&&(this.isTypeSet||(this.nzType="warning"),this.isShowIconSet||(this.nzShowIcon=!0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(U.a),c.Tb(c.h))},e.\u0275cmp=c.Nb({type:e,selectors:[["nz-alert"]],inputs:{nzCloseText:"nzCloseText",nzIconType:"nzIconType",nzMessage:"nzMessage",nzDescription:"nzDescription",nzType:"nzType",nzBanner:"nzBanner",nzShowIcon:"nzShowIcon",nzCloseable:"nzCloseable"},outputs:{nzOnClose:"nzOnClose"},exportAs:["nzAlert"],features:[c.Ab],decls:1,vars:1,consts:[["class","ant-alert",3,"ant-alert-success","ant-alert-info","ant-alert-warning","ant-alert-error","ant-alert-no-icon","ant-alert-banner","ant-alert-closable","ant-alert-with-description",4,"ngIf"],[1,"ant-alert"],[4,"ngIf"],["class","ant-alert-message",4,"ngIf"],["class","ant-alert-description",4,"ngIf"],["type","button","tabindex","0","class","ant-alert-close-icon",3,"click",4,"ngIf"],["nz-icon","",1,"ant-alert-icon",3,"nzType","nzTheme"],[1,"ant-alert-message"],[4,"nzStringTemplateOutlet"],[1,"ant-alert-description"],["type","button","tabindex","0",1,"ant-alert-close-icon",3,"click"],["closeDefaultTemplate",""],[4,"ngIf","ngIfElse"],["nz-icon","","nzType","close"],[1,"ant-alert-close-text"]],template:function(e,t){1&e&&c.Gc(0,Ae,5,21,"div",0),2&e&&c.qc("ngIf",!t.closed)},directives:[i.m,y.b,ge.b],encapsulation:2,data:{animation:[ze.e]},changeDetection:0}),Object(P.a)([Object(U.b)("alert",!1),Object(fe.a)(),Object(P.b)("design:type",Boolean)],e.prototype,"nzCloseable",void 0),Object(P.a)([Object(U.b)("alert",!1),Object(fe.a)(),Object(P.b)("design:type",Boolean)],e.prototype,"nzShowIcon",void 0),Object(P.a)([Object(fe.a)(),Object(P.b)("design:type",Object)],e.prototype,"nzBanner",void 0),e})(),Fe=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[i.c,y.c,ge.a]]}),e})();var Me=n("nLfN");const Oe=["template"];function De(e,t){if(1&e&&(c.Xb(0),c.Ic(1),c.Wb()),2&e){const e=c.kc(2);c.Cb(1),c.Jc(e.nzDot)}}function qe(e,t){if(1&e&&(c.Zb(0,"li",1),c.Ub(1,"div",2),c.Zb(2,"div",3),c.Gc(3,De,2,1,"ng-container",4),c.Yb(),c.Zb(4,"div",5),c.oc(5),c.Yb(),c.Yb()),2&e){const e=c.kc();c.Jb("ant-timeline-item-right","right"===e.position)("ant-timeline-item-left","left"===e.position)("ant-timeline-item-last",e.isLast),c.Cb(2),c.Fc("border-color",e.borderColor),c.Jb("ant-timeline-item-head-red","red"===e.nzColor)("ant-timeline-item-head-blue","blue"===e.nzColor)("ant-timeline-item-head-green","green"===e.nzColor)("ant-timeline-item-head-gray","gray"===e.nzColor)("ant-timeline-item-head-custom",!!e.nzDot),c.Cb(1),c.qc("nzStringTemplateOutlet",e.nzDot)}}const Pe=["*"];function Ue(e,t){if(1&e&&c.Vb(0,4),2&e){c.kc();const e=c.yc(5);c.qc("ngTemplateOutlet",e)}}function Ee(e,t){}function _e(e,t){if(1&e&&(c.Xb(0),c.Gc(1,Ee,0,0,"ng-template",4),c.Wb()),2&e){const e=t.$implicit;c.Cb(1),c.qc("ngTemplateOutlet",e.template)}}function Ne(e,t){if(1&e&&c.Vb(0,4),2&e){c.kc();const e=c.yc(5);c.qc("ngTemplateOutlet",e)}}function Ge(e,t){1&e&&c.Ub(0,"i",12)}function Ve(e,t){if(1&e&&(c.Xb(0),c.Ic(1),c.Gc(2,Ge,1,0,"i",11),c.Wb()),2&e){const e=c.kc(3);c.Cb(1),c.Kc(" ",e.nzPendingDot,""),c.Cb(1),c.qc("ngIf",!e.nzPendingDot)}}function xe(e,t){if(1&e&&(c.Xb(0),c.Ic(1),c.Wb()),2&e){const e=c.kc(3);c.Cb(1),c.Kc(" ",e.isPendingBoolean?"":e.nzPending," ")}}function Re(e,t){if(1&e&&(c.Zb(0,"li",6),c.Ub(1,"div",7),c.Zb(2,"div",8),c.Gc(3,Ve,3,2,"ng-container",9),c.Yb(),c.Zb(4,"div",10),c.Gc(5,xe,2,1,"ng-container",9),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.qc("nzStringTemplateOutlet",e.nzPendingDot),c.Cb(2),c.qc("nzStringTemplateOutlet",e.nzPending)}}function Be(e,t){if(1&e&&c.Gc(0,Re,6,2,"li",5),2&e){const e=c.kc();c.qc("ngIf",e.nzPending)}}const Le=["red","blue","green","grey","gray"];let $e=(()=>{class e{constructor(e){this.cdr=e,this.nzColor="blue",this.isLast=!1,this.borderColor=null}ngOnChanges(e){e.nzColor&&this.updateCustomColor()}detectChanges(){this.cdr.detectChanges()}updateCustomColor(){var e;this.borderColor=(e=this.nzColor,-1!==Le.findIndex(t=>t===e)?null:this.nzColor)}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(c.h))},e.\u0275cmp=c.Nb({type:e,selectors:[["nz-timeline-item"],["","nz-timeline-item",""]],viewQuery:function(e,t){var n;1&e&&c.Mc(Oe,!0),2&e&&c.xc(n=c.ic())&&(t.template=n.first)},inputs:{nzColor:"nzColor",nzDot:"nzDot"},exportAs:["nzTimelineItem"],features:[c.Ab],ngContentSelectors:Pe,decls:2,vars:0,consts:[["template",""],[1,"ant-timeline-item"],[1,"ant-timeline-item-tail"],[1,"ant-timeline-item-head"],[4,"nzStringTemplateOutlet"],[1,"ant-timeline-item-content"]],template:function(e,t){1&e&&(c.pc(),c.Gc(0,qe,6,19,"ng-template",null,0,c.Hc))},directives:[ge.b],encapsulation:2,changeDetection:0}),e})(),He=(()=>{class e{constructor(e){this.cdr=e,this.nzReverse=!1,this.isPendingBoolean=!1,this.timelineItems=[],this.destroy$=new E.a}ngOnChanges(e){const{nzMode:t,nzReverse:n,nzPending:i}=e;(Je(t)||Je(n))&&this.updateChildren(),i&&(this.isPendingBoolean=!0===i.currentValue)}ngAfterContentInit(){this.updateChildren(),this.listOfItems.changes.pipe(Object(N.a)(this.destroy$)).subscribe(()=>{this.updateChildren()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateChildren(){if(this.listOfItems&&this.listOfItems.length){const e=this.listOfItems.length;this.listOfItems.forEach((t,n)=>{t.isLast=this.nzReverse?0===n:n===e-1,t.position="left"!==this.nzMode&&this.nzMode?"right"===this.nzMode?"right":"alternate"===this.nzMode&&n%2==0?"left":"right":void 0,t.detectChanges()}),this.timelineItems=this.nzReverse?this.listOfItems.toArray().reverse():this.listOfItems.toArray()}this.cdr.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(c.h))},e.\u0275cmp=c.Nb({type:e,selectors:[["nz-timeline"]],contentQueries:function(e,t,n){var i;1&e&&c.Lb(n,$e,!1),2&e&&c.xc(i=c.ic())&&(t.listOfItems=i)},inputs:{nzReverse:"nzReverse",nzMode:"nzMode",nzPending:"nzPending",nzPendingDot:"nzPendingDot"},exportAs:["nzTimeline"],features:[c.Ab],ngContentSelectors:Pe,decls:7,vars:11,consts:[[1,"ant-timeline"],[3,"ngTemplateOutlet",4,"ngIf"],[4,"ngFor","ngForOf"],["pendingTemplate",""],[3,"ngTemplateOutlet"],["class","ant-timeline-item ant-timeline-item-pending",4,"ngIf"],[1,"ant-timeline-item","ant-timeline-item-pending"],[1,"ant-timeline-item-tail"],[1,"ant-timeline-item-head","ant-timeline-item-head-custom","ant-timeline-item-head-blue"],[4,"nzStringTemplateOutlet"],[1,"ant-timeline-item-content"],["nz-icon","","nzType","loading",4,"ngIf"],["nz-icon","","nzType","loading"]],template:function(e,t){1&e&&(c.pc(),c.Zb(0,"ul",0),c.Gc(1,Ue,1,1,"ng-container",1),c.Gc(2,_e,2,1,"ng-container",2),c.Gc(3,Ne,1,1,"ng-container",1),c.Yb(),c.Gc(4,Be,1,1,"ng-template",null,3,c.Hc),c.oc(6)),2&e&&(c.Jb("ant-timeline-right","right"===t.nzMode)("ant-timeline-alternate","alternate"===t.nzMode)("ant-timeline-pending",!!t.nzPending)("ant-timeline-reverse",t.nzReverse),c.Cb(1),c.qc("ngIf",t.nzReverse),c.Cb(1),c.qc("ngForOf",t.timelineItems),c.Cb(1),c.qc("ngIf",!t.nzReverse))},directives:[i.m,i.l,i.r,ge.b,y.b],encapsulation:2,changeDetection:0}),e})();function Je(e){return!(!e||e.previousValue===e.currentValue&&!e.isFirstChange())}let We=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[i.c,Me.b,y.c,ge.a]]}),e})();var je=n("PTRe"),Xe=n("pjuo");let Qe=(()=>{class e{constructor(e){this.http=e,this.API_URL=b.a.apiUrl+"/payrolls"}getByMonth(e){return this.http.get(this.API_URL+`/${e}`)}create(e){return this.http.post(this.API_URL+`/${e}`,null)}approve(e){return this.http.post(this.API_URL+`/${e}/approved`,null)}unapproved(e){return this.http.post(this.API_URL+`/${e}/unapproved`,null)}refresh(e){return this.http.post(this.API_URL+`/${e}/refresh`,null)}getItemStatus(e){return this.http.get(this.API_URL+`/${e}/items-status`)}requestDownload(e){return this.http.post(this.API_URL+`/${e}/download`,null)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(S.c))},e.\u0275prov=c.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ke=(()=>{class e{transform(t,n,i){if(!t)return t;let o=[];if(i&&"and"===i){o=[...t];for(let t=0;t<n.length;t++){const i=n[t];o=o.filter(t=>!i.value||(e.getVal(i.key,t)+"").includes(i.value.trim()))}}else console.log(n.length),o=t.filter(t=>{for(let i=0;i<n.length;i++){const o=n[i];if(!o.value||(e.getVal(o.key,t)+"").includes(o.value.trim()))return!0}return!1});return o}static getVal(e,t){const n=e.split("->");let i=t;for(const o of n){if(void 0===i[o.trim()]||null===i[o.trim()])return"";i=i[o.trim()]}return i}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"search",type:e,pure:!0}),e})(),et=(()=>{class e{transform(e){return e?e.substring(0,e.indexOf("@")):""}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"emailName",type:e,pure:!0}),e})(),tt=(()=>{class e{transform(e){if(!e)return"Unknown";switch(e){case"FEES":return"Fees";case"ALLOWANCES":return"Allowances";case"TIMESHEET":return"Timesheet";case"BONUS":return"Bonus";default:return"Unknown"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"payrollChecklistCodeToText",type:e,pure:!0}),e})();function nt(e,t){1&e&&(c.Zb(0,"nz-tag",17),c.Ic(1,"Approved"),c.Yb()),2&e&&c.qc("nzColor","#87d068")}function it(e,t){if(1&e&&(c.Zb(0,"span"),c.Ic(1,"Have no payroll for "),c.Zb(2,"nz-tag"),c.Ic(3),c.lc(4,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.Jc(c.nc(4,1,e.date,"MM/yyyy"))}}function ot(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",21),c.hc("click",(function(){return c.zc(e),c.kc(2).onCreate()})),c.Ic(1,"Create Now"),c.Yb()}if(2&e){const e=c.kc(2);c.qc("disabled",!e.date)("nzLoading",e.isCreating)}}function ct(e,t){if(1&e&&(c.Zb(0,"nz-empty",18),c.Gc(1,it,5,4,"ng-template",null,19,c.Hc),c.Gc(3,ot,2,2,"ng-template",null,20,c.Hc),c.Yb()),2&e){const e=c.yc(2),t=c.yc(4);c.qc("nzNotFoundContent",e)("nzNotFoundFooter",t)}}function st(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",7),c.hc("click",(function(){return c.zc(e),c.kc(2).approve()})),c.Ub(2,"i",49),c.Ic(3," Approve"),c.Yb(),c.Yb()}}function rt(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",50),c.hc("click",(function(){return c.zc(e),c.kc(2).unapproved()})),c.Ub(2,"i",51),c.Ic(3," Unapproved"),c.Yb(),c.Yb()}}const at=function(e){return{fontSize:e}};function lt(e,t){if(1&e&&(c.Zb(0,"tr"),c.Zb(1,"td",52),c.Zb(2,"span",53),c.Ic(3),c.lc(4,"emailName"),c.Yb(),c.Yb(),c.Zb(5,"td",52),c.Ic(6),c.Yb(),c.Zb(7,"td"),c.Ic(8),c.Yb(),c.Zb(9,"td"),c.Ic(10),c.Yb(),c.Zb(11,"td"),c.Ic(12),c.lc(13,"number"),c.Yb(),c.Zb(14,"td"),c.Ic(15),c.lc(16,"number"),c.Yb(),c.Zb(17,"td"),c.Ic(18),c.Yb(),c.Zb(19,"td"),c.Ic(20),c.Yb(),c.Zb(21,"td"),c.Ic(22),c.lc(23,"number"),c.Yb(),c.Zb(24,"td"),c.Ic(25),c.lc(26,"number"),c.Yb(),c.Zb(27,"td"),c.Ic(28),c.lc(29,"number"),c.Yb(),c.Zb(30,"td"),c.Ic(31),c.lc(32,"number"),c.Yb(),c.Zb(33,"td"),c.Ic(34),c.lc(35,"number"),c.Yb(),c.Zb(36,"td"),c.Ic(37),c.lc(38,"number"),c.Yb(),c.Zb(39,"td"),c.Ic(40),c.lc(41,"number"),c.Yb(),c.Zb(42,"td"),c.Ic(43),c.lc(44,"number"),c.Yb(),c.Zb(45,"td"),c.Ic(46),c.lc(47,"number"),c.Yb(),c.Zb(48,"td"),c.Ic(49),c.lc(50,"number"),c.Yb(),c.Zb(51,"td"),c.Ic(52),c.lc(53,"number"),c.Yb(),c.Zb(54,"td"),c.Ic(55),c.Yb(),c.Zb(56,"td"),c.Ic(57),c.Yb(),c.Zb(58,"td"),c.Ic(59),c.lc(60,"number"),c.Yb(),c.Zb(61,"td"),c.Ic(62),c.lc(63,"number"),c.Yb(),c.Zb(64,"td"),c.Ic(65),c.lc(66,"number"),c.Yb(),c.Zb(67,"td"),c.Ic(68),c.lc(69,"number"),c.Yb(),c.Zb(70,"td"),c.Ic(71),c.lc(72,"number"),c.Yb(),c.Zb(73,"td"),c.Ic(74),c.lc(75,"number"),c.Yb(),c.Zb(76,"td"),c.Ic(77),c.Yb(),c.Zb(78,"td"),c.Ic(79),c.Yb(),c.Zb(80,"td"),c.Ic(81),c.lc(82,"number"),c.Yb(),c.Zb(83,"td",48),c.Zb(84,"nz-space"),c.Zb(85,"nz-space-item"),c.Zb(86,"button",54),c.Ub(87,"i",55),c.Yb(),c.Yb(),c.Zb(88,"nz-space-item"),c.Zb(89,"button",56),c.Ub(90,"i",57),c.Yb(),c.Yb(),c.Zb(91,"nz-space-item"),c.Zb(92,"button",58),c.Ub(93,"i",59),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e){const e=t.$implicit,n=c.kc(2);c.Ec(c.uc(75,at,n.setting.fontSize+"px")),c.Cb(2),c.qc("nzTooltipTitle",e.employee.email),c.Cb(1),c.Jc(c.mc(4,33,e.employee.email)),c.Cb(3),c.Jc(e.employee.fullName),c.Cb(2),c.Jc(e.employee.position),c.Cb(2),c.Jc(e.employee.company),c.Cb(2),c.Jc(c.mc(13,35,e.socialInsurance.contributionFixed)),c.Cb(3),c.Jc(c.mc(16,37,e.currentSalary.amount)),c.Cb(3),c.Jc(e.timeSheet.standardWorkingHours),c.Cb(2),c.Jc(e.timeSheet.actualWorkingHours),c.Cb(2),c.Jc(c.mc(23,39,e.summary.calculatedSalary)),c.Cb(3),c.Jc(c.mc(26,41,e.summary.bizTripDaysToMoney)),c.Cb(3),c.Jc(c.mc(29,43,e.allowances.totalAmount)),c.Cb(3),c.Jc(c.mc(32,45,e.summary.ot100ToMoney)),c.Cb(3),c.Jc(c.mc(35,47,e.summary.ot120ToMoney)),c.Cb(3),c.Jc(c.mc(38,49,e.summary.ot150ToMoney)),c.Cb(3),c.Jc(c.mc(41,51,e.allowances.groups.COMPENSATION)),c.Cb(3),c.Jc(c.mc(44,53,e.bonuses.totalAmount)),c.Cb(3),c.Jc(c.mc(47,55,e.summary.total)),c.Cb(3),c.Jc(c.mc(50,57,e.socialInsurance.contribution)),c.Cb(3),c.Jc(c.mc(53,59,e.summary.incomeBeforeTaxes)),c.Cb(3),c.Jc(e.socialInsurance.dependents),c.Cb(2),c.Jc(e.socialInsurance.familyAllowance),c.Cb(2),c.Jc(c.mc(60,61,e.taxes.taxableIncome)),c.Cb(3),c.Jc(c.mc(63,63,e.taxes.personalIncomeTax)),c.Cb(3),c.Jc(c.mc(66,65,e.fees.groups.UTILITY_BILLS)),c.Cb(3),c.Jc(c.mc(69,67,e.fees.groups.ADVANCES_AND_OTHER)),c.Cb(3),c.Jc(c.mc(72,69,e.summary.realField)),c.Cb(3),c.Jc(c.mc(75,71,e.summary.actualIncome)),c.Cb(3),c.Jc(e.bankInfo.bankCode),c.Cb(2),c.Jc(e.bankInfo.accountCode),c.Cb(2),c.Jc(c.mc(82,73,e.bankInfo.payRounded))}}const bt=function(e){return{x:e,y:"500px"}},pt=function(e){return{key:"employee -> email",value:e}},dt=function(e){return{key:"employee -> fullName",value:e}},ht=function(e,t){return[e,t]},ut=function(e){return{fontSize:e,textAlign:"center"}};function mt(e,t){if(1&e){const e=c.ac();c.Zb(0,"div",22),c.Zb(1,"div",23),c.Zb(2,"div",24),c.Zb(3,"nz-space"),c.Zb(4,"nz-space-item"),c.Zb(5,"button",25),c.hc("click",(function(){return c.zc(e),c.kc().zoomOut()})),c.Ub(6,"i",26),c.Yb(),c.Yb(),c.Zb(7,"nz-space-item"),c.Zb(8,"button",25),c.hc("click",(function(){return c.zc(e),c.kc().zoomIn()})),c.Ub(9,"i",27),c.Yb(),c.Yb(),c.Zb(10,"nz-space-item"),c.Zb(11,"form",28),c.hc("ngSubmit",(function(){return c.zc(e),c.kc().searchFormSubmit()})),c.Zb(12,"nz-form-item",29),c.Zb(13,"nz-form-control"),c.Ub(14,"input",30),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(15,"div",31),c.Zb(16,"nz-space"),c.Gc(17,st,4,0,"nz-space-item",32),c.Gc(18,rt,4,0,"nz-space-item",32),c.Yb(),c.Yb(),c.Yb(),c.Zb(19,"div",33),c.Zb(20,"nz-table",34,35),c.lc(22,"search"),c.Zb(23,"thead"),c.Zb(24,"tr"),c.Ub(25,"th",36),c.Ub(26,"th",36),c.Zb(27,"th",37),c.Ic(28,"Basic information"),c.Yb(),c.Zb(29,"th",38),c.Ic(30,"Income increased"),c.Yb(),c.Ub(31,"th",39),c.Zb(32,"th",40),c.Ic(33,"Insurances and taxes"),c.Yb(),c.Zb(34,"th",41),c.Ic(35,"Fees"),c.Yb(),c.Ub(36,"th",42),c.Zb(37,"th",43),c.Ic(38,"Bank information"),c.Yb(),c.Ub(39,"th",44),c.Yb(),c.Zb(40,"tr"),c.Zb(41,"th",45),c.Ic(42,"Email"),c.Yb(),c.Zb(43,"th",45),c.Ic(44,"Full name"),c.Yb(),c.Zb(45,"th"),c.Ic(46,"Position"),c.Yb(),c.Zb(47,"th"),c.Ic(48,"Biz"),c.Yb(),c.Zb(49,"th"),c.Zb(50,"span",46),c.Ic(51,"SI limit"),c.Yb(),c.Yb(),c.Zb(52,"th"),c.Ic(53,"Salary"),c.Yb(),c.Zb(54,"th"),c.Ic(55,"Standard working hours"),c.Yb(),c.Zb(56,"th"),c.Ic(57,"Actual working hours"),c.Yb(),c.Zb(58,"th"),c.Ic(59,"Salary calculation"),c.Yb(),c.Zb(60,"th"),c.Ic(61,"Biz fee"),c.Yb(),c.Zb(62,"th"),c.Ic(63,"Allowances"),c.Yb(),c.Zb(64,"th"),c.Ic(65,"OT 100%"),c.Yb(),c.Zb(66,"th"),c.Ic(67,"OT 120%"),c.Yb(),c.Zb(68,"th"),c.Ic(69,"OT 150%"),c.Yb(),c.Zb(70,"th"),c.Ic(71,"Offset amount"),c.Yb(),c.Zb(72,"th"),c.Ic(73,"Bonus"),c.Yb(),c.Zb(74,"th"),c.Ic(75,"Total"),c.Yb(),c.Zb(76,"th"),c.Zb(77,"span",47),c.Ic(78,"SI contribution"),c.Yb(),c.Yb(),c.Zb(79,"th"),c.Ic(80,"Income before tax"),c.Yb(),c.Zb(81,"th"),c.Ic(82,"Dependent"),c.Yb(),c.Zb(83,"th"),c.Ic(84,"Family allowance"),c.Yb(),c.Zb(85,"th"),c.Ic(86,"Taxable income"),c.Yb(),c.Zb(87,"th"),c.Ic(88,"Personal income tax"),c.Yb(),c.Zb(89,"th"),c.Ic(90,"Utility bill"),c.Yb(),c.Zb(91,"th"),c.Ic(92,"Advance payment / other deductions"),c.Yb(),c.Zb(93,"th"),c.Ic(94,"Actual income"),c.Yb(),c.Zb(95,"th"),c.Ic(96,"Real field"),c.Yb(),c.Zb(97,"th"),c.Ic(98,"Bank name"),c.Yb(),c.Zb(99,"th"),c.Ic(100,"Bank account"),c.Yb(),c.Zb(101,"th"),c.Ic(102,"Bank transfer amount"),c.Yb(),c.Zb(103,"th",48),c.Ic(104,"Action"),c.Yb(),c.Yb(),c.Yb(),c.Zb(105,"tbody"),c.Gc(106,lt,94,77,"ng-template",15),c.Yb(),c.Yb(),c.Yb(),c.Yb()}if(2&e){const e=c.yc(21),t=c.kc();c.Cb(5),c.qc("nzType",t.setting.fontSize<t.setting.fontSizeDefault?"primary":"dashed")("disabled",t.setting.fontSize<=8),c.Cb(3),c.qc("nzType",t.setting.fontSize>t.setting.fontSizeDefault?"primary":"dashed")("disabled",t.setting.fontSize>=t.setting.fontSizeDefault+2),c.Cb(3),c.qc("formGroup",t.searchForm),c.Cb(6),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",t.isApproved),c.Cb(2),c.qc("nzScroll",c.uc(26,bt,31*t.setting.avgColumnsWidth+"px"))("nzData",c.nc(22,23,t.listOfData,c.vc(32,ht,c.uc(28,pt,t.searchQuery),c.uc(30,dt,t.searchQuery))))("nzFrontPagination",!1),c.Cb(5),c.qc("width",t.setting.avgColumnsWidth),c.Cb(1),c.qc("width",t.setting.avgColumnsWidth),c.Cb(1),c.qc("width",7*t.setting.avgColumnsWidth),c.Cb(2),c.qc("width",7*t.setting.avgColumnsWidth),c.Cb(2),c.qc("width",t.setting.avgColumnsWidth),c.Cb(1),c.qc("width",6*t.setting.avgColumnsWidth),c.Cb(2),c.qc("width",2*t.setting.avgColumnsWidth),c.Cb(2),c.qc("width",2*t.setting.avgColumnsWidth),c.Cb(1),c.qc("width",3*t.setting.avgColumnsWidth),c.Cb(2),c.qc("width",t.setting.avgColumnsWidth),c.Cb(1),c.Ec(c.uc(35,ut,t.setting.fontSize-1+"px")),c.Cb(66),c.qc("ngForOf",e.data)}}function zt(e,t){if(1&e&&(c.Zb(0,"nz-timeline-item"),c.Zb(1,"b"),c.Ic(2),c.lc(3,"payrollChecklistCodeToText"),c.Yb(),c.Ic(4," approved at "),c.Zb(5,"nz-tag",61),c.Ic(6),c.lc(7,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc().$implicit;c.Cb(2),c.Jc(c.mc(3,2,e.code)),c.Cb(4),c.Jc(c.nc(7,4,e.approvedAt,"dd/MM/yyyy HH:mm"))}}function ft(e,t){if(1&e&&(c.Zb(0,"nz-timeline-item",62),c.Zb(1,"b"),c.Ic(2),c.lc(3,"payrollChecklistCodeToText"),c.Yb(),c.Ic(4," is pending... "),c.Yb()),2&e){const e=c.kc().$implicit;c.kc();const t=c.yc(26);c.qc("nzDot",t),c.Cb(2),c.Kc("",c.mc(3,2,e.code)," ")}}function gt(e,t){if(1&e&&(c.Gc(0,zt,8,7,"nz-timeline-item",32),c.Gc(1,ft,5,4,"nz-timeline-item",60)),2&e){const e=t.$implicit;c.qc("ngIf",e.approvedAt),c.Cb(1),c.qc("ngIf",!e.approvedAt)}}function yt(e,t){1&e&&c.Ub(0,"i",63)}new Date(1588266e6);let Ct=(()=>{class e{constructor(e,t,n,i,o,c){this.fb=e,this.route=t,this.message=n,this.modal=i,this.employeeService=o,this.payrollService=c,this.date=new Date,this.isApproved=!1,this.listOfData=[],this.isModalVisible=!1,this.isCreated=!1,this.isCreating=!1,this.isApproving=!1,this.employees=[],this.checkList=[],this.isValid=!1,this.setting={fontSize:12,fontSizeDefault:12,columns:{email:{width:90},fullName:{width:150},action:{width:100}},avgColumnsWidth:110}}ngOnInit(){this.getEmployee(),this.loadPayroll(),this.searchForm=this.fb.group({searchQuery:[null,[]]})}onMonthChange(e){console.log("onChange: ",e)}onThisMonth(){this.date=new Date}onCreate(){this.isCreating=!0;const e=a(this.date).format("YYYY-MM");this.payrollService.getItemStatus(e).subscribe(t=>{if(this.isValid=t.valid,this.checkList=t.items,!this.isValid)return this.isCreating=!1,void(this.isModalVisible=!0);this.payrollService.create(e).subscribe(e=>{this.isCreated=!0,this.isCreating=!1,this.listOfData=e.items},e=>{this.isCreating=!1})},e=>this.isCreating=!1)}approve(){this.modal.confirm({nzTitle:"Do you Want to approve this timesheet?",nzContent:"Once you approved, you can still edit it later",nzOnOk:()=>new Promise((e,t)=>{setTimeout(Math.random()>.5?e:t,1e3)}).then(()=>{this.isApproved=!0,this.message.info("Approve successfully!")}).catch(()=>{console.log("Oops errors!"),this.isApproved=!0})})}unapproved(){this.isApproved=!1}handleModalCancel(){this.isModalVisible=!1}handleModalOk(){this.isValid=!0,this.isModalVisible=!1}zoomOut(){this.setting.fontSize--}zoomIn(){this.setting.fontSize++}searchFormSubmit(){this.searchQuery=this.searchForm.get("searchQuery").value}loadPayroll(){const e=a(this.date).format("YYYY-MM");this.payrollService.getByMonth(e).subscribe(e=>{e.available?(this.isCreated=!0,this.isApproved=e.status&&"APPROVED"===e.status,this.listOfData=e.items):this.refresh()},e=>{this.isCreated=!1,this.isApproved=!1,this.listOfData=[]})}refresh(){const e=a(this.date).format("YYYY-MM");this.payrollService.refresh(e).subscribe(e=>{this.isCreated=!0,this.isApproved=e.status&&"APPROVED"===e.status,this.listOfData=e.items},e=>{this.isCreated=!1,this.isApproved=!1,this.listOfData=[]})}getEmployee(){this.employeeService.getAll().subscribe(e=>{this.employees=e})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(r.c),c.Tb(o.c),c.Tb(m.b),c.Tb(z.c),c.Tb(Xe.a),c.Tb(Qe))},e.\u0275cmp=c.Nb({type:e,selectors:[["app-payroll"]],decls:27,vars:10,consts:[[1,"wrap"],[1,"page-header"],["class","ml-1",3,"nzColor",4,"ngIf"],["nz-button","","nzType","primary","nzShape","circle"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-icon","","nzType","arrow-right","nzTheme","outline"],["nzPlaceHolder","Select month",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],[1,"page-content"],[3,"nzNotFoundContent","nzNotFoundFooter",4,"ngIf"],["class","form-wrap",4,"ngIf"],["nzTitle","Check list to create a payroll for this month",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nzShowIcon","","nzType","warning","nzMessage","Please approve parts with pending status below:",2,"width","100%"],[1,"timeline"],["ngFor","",3,"ngForOf"],["pendingDot",""],[1,"ml-1",3,"nzColor"],[3,"nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],[1,"form-wrap"],["nz-row","",1,"page-action"],["nz-col","","nzSpan","8"],["nz-button","","nzShape","circle",3,"nzType","disabled","click"],["nz-icon","","nzType","zoom-out","nzTheme","outline"],["nz-icon","","nzType","zoom-in","nzTheme","outline"],["nz-form","",3,"formGroup","ngSubmit"],[1,"m-0"],["placeholder","Enter email, full name to search","nz-input","","id","searchQuery","formControlName","searchQuery",2,"width","300px"],["nz-col","","nzSpan","16",1,"text-right"],[4,"ngIf"],[1,"data-table-wrap"],[1,"data-table",3,"nzScroll","nzData","nzFrontPagination"],["fixedTable",""],["colspan","1","nzLeft","",2,"background","#A2ADB8",3,"width"],["colspan","7",2,"background","#72D0FF",3,"width"],["colspan","7",2,"background","#8AC94D",3,"width"],["colspan","1",2,"background","#72D0FF",3,"width"],["colspan","6",2,"background","#FFA071",3,"width"],["colspan","2",2,"background","#FF884D",3,"width"],["colspan","2",2,"background","#72D0FF",3,"width"],["colspan","3",2,"background","#FFD170",3,"width"],["colspan","1","nzRight","",2,"background","#A2ADB8",3,"width"],["nzLeft","","rowspan","2"],["nz-tooltip","","nzTooltipTitle","Social insurance contribution limit"],["nz-tooltip","","nzTooltipTitle","Social insurance contribution in real"],["nzRight",""],["nz-icon","","nzType","check"],["nz-button","","nzType","default","nzDanger","","nzShape","round",3,"click"],["nz-icon","","nzType","stop"],["nzLeft",""],["nz-tooltip","",3,"nzTooltipTitle"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Preview"],["nz-icon","","nzType","eye"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Send email"],["nz-icon","","nzType","send"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Send for me"],["nz-icon","","nzType","mail"],[3,"nzDot",4,"ngIf"],["nzColor","blue"],[3,"nzDot"],["nz-icon","","nzType","loading","nzTheme","outline"]],template:function(e,t){1&e&&(c.Zb(0,"div",0),c.Zb(1,"nz-page-header",1),c.Zb(2,"nz-page-header-title"),c.Ic(3,"Payroll"),c.Yb(),c.Zb(4,"nz-page-header-subtitle"),c.Ic(5),c.lc(6,"date"),c.Gc(7,nt,2,1,"nz-tag",2),c.Yb(),c.Zb(8,"nz-page-header-extra"),c.Zb(9,"button",3),c.Ub(10,"i",4),c.Yb(),c.Zb(11,"button",3),c.Ub(12,"i",5),c.Yb(),c.Zb(13,"nz-month-picker",6),c.hc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.onMonthChange(e)})),c.Yb(),c.Zb(14,"button",7),c.hc("click",(function(){return t.onThisMonth()})),c.Ub(15,"i",8),c.Ic(16,"This month "),c.Yb(),c.Yb(),c.Yb(),c.Zb(17,"div",9),c.Gc(18,ct,5,2,"nz-empty",10),c.Gc(19,mt,107,37,"div",11),c.Yb(),c.Yb(),c.Zb(20,"nz-modal",12),c.hc("nzVisibleChange",(function(e){return t.isModalVisible=e}))("nzOnCancel",(function(){return t.handleModalCancel()}))("nzOnOk",(function(){return t.handleModalOk()})),c.Ub(21,"nz-alert",13),c.Zb(22,"div",14),c.Zb(23,"nz-timeline"),c.Gc(24,gt,2,2,"ng-template",15),c.Yb(),c.Yb(),c.Gc(25,yt,1,0,"ng-template",null,16,c.Hc),c.Yb()),2&e&&(c.Cb(5),c.Kc("",c.nc(6,7,t.date,"MM/yyyy")," "),c.Cb(2),c.qc("ngIf",t.isApproved),c.Cb(6),c.qc("ngModel",t.date),c.Cb(5),c.qc("ngIf",!t.isCreated),c.Cb(1),c.qc("ngIf",t.isCreated),c.Cb(1),c.qc("nzVisible",t.isModalVisible),c.Cb(4),c.qc("ngForOf",t.checkList))},directives:[f.a,f.e,f.d,i.m,f.b,g.a,O.a,D.a,y.b,C.a,C.c,r.k,r.m,z.a,Se,He,i.l,v.a,Z.b,q.c,q.a,R,x,r.p,r.l,Y.b,r.g,Y.c,Y.a,je.b,r.b,r.f,k.c,k.g,k.h,k.b,k.f,k.a,T.d,k.e,$e],pipes:[i.e,Ke,et,i.f,tt],styles:[".page-action[_ngcontent-%COMP%]{padding-bottom:25px}nz-empty[_ngcontent-%COMP%]{margin-top:50px}.timeline[_ngcontent-%COMP%]{padding-top:30px;padding-left:20px}.data-table-wrap[_ngcontent-%COMP%]{width:100%;overflow:hidden}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;padding:5px}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}"]}),e})(),Yt=(()=>{class e{transform(e){if(!e)return"";switch(e){case me.UTILITY_BILLS:return"Utility bills";case me.PERSONAL_TRAVEL_FEES:return"Personal travel fees";case me.ADVANCES:return"Advances";case me.ARREARS:return"Arrears";case me.OTHER:return"Other"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"feeTypeName",type:e,pure:!0}),e})();class It{}class vt{}class Zt{}class Tt{}var kt=n("zAKX"),wt=n("5vDB"),At=n("+oEP");let St=(()=>{class e{constructor(e){this.http=e,this.API_URL=b.a.apiUrl+"/fees"}getByMonth(e){return this.http.get(this.API_URL+`/${e}`)}create(e){return this.http.post(this.API_URL,e)}updateByEmployee(e,t,n){return this.http.put(this.API_URL+`/${e}/${t}`,n)}deleteByEmployee(e,t,n){return this.http.delete(this.API_URL+`/${e}/${t}`)}statuses(e,t){return this.http.post(this.API_URL+`/${e}/statuses`,t)}addByEmployee(e,t){return this.http.post(this.API_URL+`/${e}`,t)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(S.c))},e.\u0275prov=c.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ft=(()=>{class e{transform(e,t){return e?e.map(e=>+e[t]).reduce((e,t)=>e+t):0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"sumByField",type:e,pure:!0}),e})(),Mt=(()=>{class e{transform(e,t){return e?e.length<=+t?e:e.substr(0,+t)+"...":e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"subStr",type:e,pure:!0}),e})();function Ot(e,t){1&e&&(c.Zb(0,"nz-tag",30),c.Ic(1,"Approved"),c.Yb()),2&e&&c.qc("nzColor","#87d068")}function Dt(e,t){if(1&e&&(c.Zb(0,"span"),c.Ic(1,"Have no fees for "),c.Zb(2,"nz-tag"),c.Ic(3),c.lc(4,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.Jc(c.nc(4,1,e.date,"MM/yyyy"))}}function qt(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space"),c.Zb(1,"nz-space-item"),c.Zb(2,"button",34),c.hc("click",(function(){return c.zc(e),c.kc(2).add()})),c.Ic(3,"Create Now"),c.Yb(),c.Yb(),c.Zb(4,"nz-space-item"),c.Zb(5,"button",35),c.hc("click",(function(){return c.zc(e),c.kc(2).onEmptyApprove()})),c.Ic(6,"Approve with empty fee"),c.Yb(),c.Yb(),c.Yb()}if(2&e){const e=c.kc(2);c.Cb(2),c.qc("disabled",!e.date),c.Cb(3),c.qc("disabled",!e.date)("nzLoading",e.isApproving)}}function Pt(e,t){if(1&e&&(c.Zb(0,"nz-empty",31),c.Gc(1,Dt,5,4,"ng-template",null,32,c.Hc),c.Gc(3,qt,7,3,"ng-template",null,33,c.Hc),c.Yb()),2&e){const e=c.yc(2),t=c.yc(4);c.qc("nzNotFoundContent",e)("nzNotFoundFooter",t)}}function Ut(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",7),c.hc("click",(function(){return c.zc(e),c.kc(2).approve()})),c.Ub(2,"i",41),c.Ic(3," Approve"),c.Yb(),c.Yb()}}function Et(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",42),c.hc("click",(function(){return c.zc(e),c.kc(2).unapproved()})),c.Ub(2,"i",43),c.Ic(3," Unapproved"),c.Yb(),c.Yb()}}function _t(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",22),c.hc("click",(function(){return c.zc(e),c.kc(2).add()})),c.Ub(2,"i",23),c.Yb(),c.Yb()}}function Nt(e,t){1&e&&(c.Zb(0,"th"),c.Ic(1,"##"),c.Yb())}function Gt(e,t){if(1&e){const e=c.ac();c.Zb(0,"td"),c.Zb(1,"button",47),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc(2).edit(t)})),c.Ub(2,"i",48),c.Yb(),c.Zb(3,"button",49),c.Ub(4,"i",50),c.Yb(),c.Yb()}}function Vt(e,t){if(1&e&&(c.Zb(0,"div",51),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit,t=c.kc(2);c.Cb(1),c.Jc(t.getDescription(e.items))}}function xt(e,t){if(1&e&&(c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"a",44),c.Ic(3),c.Yb(),c.Yb(),c.Zb(4,"td"),c.Ic(5),c.Yb(),c.Zb(6,"td"),c.Ic(7),c.lc(8,"number"),c.lc(9,"sumByField"),c.Yb(),c.Zb(10,"td"),c.Ic(11),c.lc(12,"subStr"),c.Ub(13,"i",45),c.Yb(),c.Gc(14,Gt,5,0,"td",38),c.Yb(),c.Gc(15,Vt,2,1,"ng-template",null,46,c.Hc)),2&e){const e=t.$implicit,n=c.yc(16),i=c.kc(2);c.Cb(2),c.sc("routerLink","/employee/detail/",e.employee.id,""),c.Cb(1),c.Jc(e.employee.email),c.Cb(2),c.Jc(e.employee.fullName),c.Cb(2),c.Jc(c.mc(8,7,c.nc(9,9,e.items,"amount"))),c.Cb(4),c.Kc(" ",c.nc(12,12,i.getDescription(e.items),"30")," "),c.Cb(2),c.qc("nzPopoverContent",n),c.Cb(1),c.qc("ngIf",!i.isApproved)}}function Rt(e,t){if(1&e&&(c.Zb(0,"div",36),c.Zb(1,"div",18),c.Zb(2,"div",37),c.Zb(3,"nz-space"),c.Gc(4,Ut,4,0,"nz-space-item",38),c.Gc(5,Et,4,0,"nz-space-item",38),c.Gc(6,_t,3,0,"nz-space-item",38),c.Yb(),c.Yb(),c.Yb(),c.Zb(7,"nz-table",39,40),c.Zb(9,"thead"),c.Zb(10,"tr"),c.Zb(11,"th"),c.Ic(12,"Email"),c.Yb(),c.Zb(13,"th"),c.Ic(14,"Name"),c.Yb(),c.Zb(15,"th"),c.Ic(16,"Total fee amount"),c.Yb(),c.Zb(17,"th"),c.Ic(18,"Detail"),c.Yb(),c.Gc(19,Nt,2,0,"th",38),c.Yb(),c.Yb(),c.Zb(20,"tbody"),c.Gc(21,xt,17,15,"ng-template",29),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(8),t=c.kc();c.Cb(4),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",t.isApproved),c.Cb(1),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("nzData",t.listOfData)("nzShowPagination",!1),c.Cb(12),c.qc("ngIf",!t.isApproved),c.Cb(2),c.qc("ngForOf",e.data)}}function Bt(e,t){if(1&e&&c.Ub(0,"nz-option",52),2&e){const e=t.$implicit;c.qc("nzLabel",e.fullName)("nzValue",e.id)}}function Lt(e,t){if(1&e&&(c.Ub(0,"nz-option",52),c.lc(1,"feeTypeName")),2&e){const e=t.$implicit;c.qc("nzLabel",c.mc(1,2,e))("nzValue",e)}}function $t(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",57),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc().removeFee(t)})),c.Ub(1,"i",50),c.Yb()}}function Ht(e,t){if(1&e){const e=c.ac();c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"nz-form-item"),c.Zb(3,"nz-form-control",15),c.Zb(4,"nz-select",53),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateFeesData()})),c.Gc(5,Lt,2,4,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(6,"td"),c.Zb(7,"nz-form-item"),c.Zb(8,"nz-form-control",15),c.Zb(9,"nz-input-number",54),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateFeesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(10,"td"),c.Zb(11,"nz-form-item"),c.Zb(12,"nz-form-control",15),c.Zb(13,"textarea",55),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateFeesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(14,"td"),c.Gc(15,$t,2,0,"button",56),c.Yb(),c.Yb()}if(2&e){const e=t.$implicit,n=c.kc();c.Cb(4),c.qc("formControlName","type_"+e.id),c.Cb(1),c.qc("ngForOf",n.feeTypes),c.Cb(4),c.qc("formControlName","amount_"+e.id),c.Cb(4),c.qc("formControlName","description_"+e.id),c.Cb(2),c.qc("ngIf",n.newFees.length>1)}}let Jt=(()=>{class e{constructor(e,t,n,i,o,c){this.fb=e,this.route=t,this.message=n,this.modal=i,this.employeeService=o,this.feeService=c,this.date=new Date,this.isApproved=!1,this.listOfData=[],this.isModalVisible=!1,this.isCreated=!1,this.isApproving=!1,this.currentFeeId=0,this.feeTypes=Object.keys(me),this.allEmployees=[],this.employees=[]}ngOnInit(){this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.newFees=[],this.getEmployee(),this.loadFee()}onMonthChange(e){this.date=e,this.loadFee()}onThisMonth(){this.date=new Date,this.loadFee()}onPrevMonth(){this.date=a(this.date).add(-1,"month").toDate(),this.loadFee()}onNextMonth(){this.date=a(this.date).add(1,"month").toDate(),this.loadFee()}onEmptyApprove(){const e=new Tt;e.month=a(this.date).format("YYYY-MM")+"-01",e.isApprove=!0,this.feeService.create(e).subscribe(e=>{this.isCreated=!0,this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Unapproved successfully!")})}handleCreateFormOk(){for(const t in this.createForm.controls)this.createForm.controls[t].markAsDirty(),this.createForm.controls[t].updateValueAndValidity();if(this.createForm.invalid)return;const e=a(this.date).format("YYYY-MM");if("ADD"===this.actionType){const t=new vt;t.employee=new Zt,t.employee.id=this.createForm.get("employeeId").value,t.items=this.newFees,t.createIfNotExist=!0,this.feeService.addByEmployee(e,t).subscribe(e=>{this.listOfData=e.items,this.isCreated=!0,this.message.info("Add successfully!")},e=>{this.message.error("Add unsuccessfully!")})}"EDIT"===this.actionType&&this.feeService.updateByEmployee(e,this.currentEmployeeId,this.newFees).subscribe(e=>{this.listOfData=e.items,this.message.info("Update successfully!")},e=>{this.message.error("Update unsuccessfully!")}),this.isModalVisible=!1}handleCreateFormCancel(){this.isModalVisible=!1,this.resetCreateForm()}approve(){this.modal.confirm({nzTitle:"Do you Want to approve this fees?",nzContent:"Once you approved, you can still edit it later",nzOnOk:()=>{const e=new u;e.status="APPROVED";const t=a(this.date).format("YYYY-MM");this.feeService.statuses(t,e).subscribe(e=>{this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Approve unsuccessfully!")})}})}unapproved(){const e=new u;e.status="UNAPPROVED";const t=a(this.date).format("YYYY-MM");this.feeService.statuses(t,e).subscribe(e=>{this.isApproved=!1,this.message.info("Unapproved successfully!")},e=>{this.message.error("Unapproved unsuccessfully!")})}add(){this.employees=this.allEmployees.filter(e=>!this.listOfData.some(t=>t.employee.id===e.id)),this.resetCreateForm(),this.addFee(),this.isModalVisible=!0,this.actionType="ADD"}edit(e){this.employees=this.allEmployees.filter(t=>t.id===e.employee.id),this.initCreateForm(e),this.isModalVisible=!0,this.actionType="EDIT"}addFee(){const e=new It;e.id=this.currentFeeId+"";const t=this.newFees;t.push(e),this.newFees=[...t],this.createForm.addControl("type_"+this.currentFeeId,new r.d(null,r.o.required)),this.createForm.addControl("amount_"+this.currentFeeId,new r.d(0,r.o.required)),this.createForm.addControl("description_"+this.currentFeeId,new r.d(null,r.o.required)),this.currentFeeId++}removeFee(e){this.createForm.removeControl("type_"+e.id),this.createForm.removeControl("amount_"+e.id),this.createForm.removeControl("description_"+e.id),this.newFees=this.newFees.filter(t=>t.id!==e.id)}updateFeesData(){for(const e of this.newFees)e.description=this.createForm.get("description_"+e.id).value,e.amount=this.createForm.get("amount_"+e.id).value,e.type=this.createForm.get("type_"+e.id).value}resetCreateForm(){this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.newFees=[],this.currentFeeId=0}initCreateForm(e){this.createForm=this.fb.group({});const t=e.items.map(e=>d.a.map(e,new vt));this.newFees=[...t],this.currentEmployeeId=e.employee.id,this.createForm.addControl("employeeId",new r.d(e.employee.id,r.o.required));for(let i=0;i<t.length;i++){const e=t[i];this.createForm.addControl("type_"+e.id,new r.d(e.type,r.o.required)),this.createForm.addControl("amount_"+e.id,new r.d(e.amount,r.o.required)),this.createForm.addControl("description_"+e.id,new r.d(e.description))}const n=t.map(e=>e.id);this.currentFeeId=Math.max.apply(Math,n)+1}getDescription(e){let t="";return e.forEach(e=>{t.length&&(t+="\n"),t+=(new Yt).transform(e.type),e.description&&(t+=" ("+e.description+")"),t+=": "+e.amount}),t}loadFee(){const e=a(this.date).format("YYYY-MM");this.feeService.getByMonth(e).subscribe(e=>{this.isCreated=!0,this.isApproved=e.status&&"APPROVED"===e.status,this.listOfData=e.items},e=>{this.isCreated=!1,this.isApproved=!1,this.listOfData=[]})}getEmployee(){this.employeeService.getAll().subscribe(e=>{this.allEmployees=e,this.employees=e})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(r.c),c.Tb(o.c),c.Tb(m.b),c.Tb(z.c),c.Tb(Xe.a),c.Tb(St))},e.\u0275cmp=c.Nb({type:e,selectors:[["app-fees"]],decls:48,vars:17,consts:[[1,"wrap"],[1,"page-header"],["class","ml-1",3,"nzColor",4,"ngIf"],["nz-button","","nzType","primary","nzShape","circle",3,"click"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-icon","","nzType","arrow-right","nzTheme","outline"],["nzPlaceHolder","Select month",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],[1,"page-content"],[3,"nzNotFoundContent","nzNotFoundFooter",4,"ngIf"],["class","form-wrap",4,"ngIf"],["nzTitle","Add fee for employees","nzWidth","1000px",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-form","",3,"formGroup"],["nzRequired","","nzFor","employee",3,"nzSm","nzXs"],["nzErrorTip","The input is required!"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a employee","id","employee","formControlName","employeeId",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","",1,"page-action"],["nz-col","","nzSpan","19"],["nzOrientation","left","nzText","Fees",1,"fee-title"],["nz-col","","nzSpan","5",1,"text-right"],["nz-button","","nzType","default","nzShape","circle","nz-tooltip","","nzTooltipTitle","Add",3,"click"],["nz-icon","","nzType","plus"],[1,"data-table",3,"nzData","nzFrontPagination"],["createTable",""],["nzWidth","300px"],["nzWidth","200px"],["nzWidth","60px"],["ngFor","",3,"ngForOf"],[1,"ml-1",3,"nzColor"],[3,"nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["nz-button","","nzType","primary",3,"disabled","click"],["nz-button","","nzType","dashed",3,"disabled","nzLoading","click"],[1,"form-wrap"],["nz-col","","nzSpan","24",1,"text-right"],[4,"ngIf"],[1,"data-table",3,"nzData","nzShowPagination"],["basicTable",""],["nz-icon","","nzType","check"],["nz-button","","nzType","default","nzDanger","","nzShape","round",3,"click"],["nz-icon","","nzType","stop"],[3,"routerLink"],["nz-icon","","nzType","info-circle","nzTheme","outline","nz-popover","","nzPopoverTitle","Detail",3,"nzPopoverContent"],["popoverContent",""],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete"],["nz-icon","","nzType","delete"],[1,"fee-desc"],[3,"nzLabel","nzValue"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a type",2,"width","100%",3,"formControlName","ngModelChange"],["nzPlaceHolder","Amount",2,"width","100%",3,"formControlName","ngModelChange"],["nz-input","","nzAutosize","","placeholder","Description",3,"formControlName","ngModelChange"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click",4,"ngIf"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click"]],template:function(e,t){if(1&e&&(c.Zb(0,"div",0),c.Zb(1,"nz-page-header",1),c.Zb(2,"nz-page-header-title"),c.Ic(3,"Fees"),c.Yb(),c.Zb(4,"nz-page-header-subtitle"),c.Ic(5),c.lc(6,"date"),c.Gc(7,Ot,2,1,"nz-tag",2),c.Yb(),c.Zb(8,"nz-page-header-extra"),c.Zb(9,"button",3),c.hc("click",(function(){return t.onPrevMonth()})),c.Ub(10,"i",4),c.Yb(),c.Zb(11,"button",3),c.hc("click",(function(){return t.onNextMonth()})),c.Ub(12,"i",5),c.Yb(),c.Zb(13,"nz-month-picker",6),c.hc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.onMonthChange(e)})),c.Yb(),c.Zb(14,"button",7),c.hc("click",(function(){return t.onThisMonth()})),c.Ub(15,"i",8),c.Ic(16,"This month "),c.Yb(),c.Yb(),c.Yb(),c.Zb(17,"div",9),c.Gc(18,Pt,5,2,"nz-empty",10),c.Gc(19,Rt,22,7,"div",11),c.Yb(),c.Yb(),c.Zb(20,"nz-modal",12),c.hc("nzVisibleChange",(function(e){return t.isModalVisible=e}))("nzOnCancel",(function(){return t.handleCreateFormCancel()}))("nzOnOk",(function(){return t.handleCreateFormOk()})),c.Zb(21,"form",13),c.Zb(22,"nz-form-item"),c.Zb(23,"nz-form-label",14),c.Ic(24,"Employee"),c.Yb(),c.Zb(25,"nz-form-control",15),c.Zb(26,"nz-select",16),c.hc("ngModelChange",(function(){return t.updateFeesData()})),c.Gc(27,Bt,1,2,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Zb(28,"div",18),c.Zb(29,"div",19),c.Ub(30,"nz-divider",20),c.Yb(),c.Zb(31,"div",21),c.Zb(32,"button",22),c.hc("click",(function(){return t.addFee()})),c.Ub(33,"i",23),c.Yb(),c.Yb(),c.Yb(),c.Zb(34,"nz-table",24,25),c.Zb(36,"thead"),c.Zb(37,"tr"),c.Zb(38,"th",26),c.Ic(39,"Type"),c.Yb(),c.Zb(40,"th",27),c.Ic(41,"Amount"),c.Yb(),c.Zb(42,"th"),c.Ic(43,"Description"),c.Yb(),c.Zb(44,"th",28),c.Ic(45,"##"),c.Yb(),c.Yb(),c.Yb(),c.Zb(46,"tbody"),c.Gc(47,Ht,16,5,"ng-template",29),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(35);c.Cb(5),c.Kc("",c.nc(6,14,t.date,"MM/yyyy")," "),c.Cb(2),c.qc("ngIf",t.isApproved),c.Cb(6),c.qc("ngModel",t.date),c.Cb(5),c.qc("ngIf",!t.isCreated),c.Cb(1),c.qc("ngIf",t.isCreated),c.Cb(1),c.qc("nzVisible",t.isModalVisible),c.Cb(1),c.qc("formGroup",t.createForm),c.Cb(2),c.qc("nzSm",6)("nzXs",24),c.Cb(3),c.qc("ngModel",t.currentEmployeeId),c.Cb(1),c.qc("ngForOf",t.employees),c.Cb(7),c.qc("nzData",t.newFees)("nzFrontPagination",!1),c.Cb(13),c.qc("ngForOf",e.data)}},directives:[f.a,f.e,f.d,i.m,f.b,g.a,O.a,D.a,y.b,C.a,C.c,r.k,r.m,z.a,r.p,r.l,Y.b,r.g,q.c,Y.c,q.a,Y.d,Y.a,kt.b,r.f,i.l,wt.a,T.d,k.c,k.g,k.h,k.b,k.f,k.e,v.a,Z.b,R,x,o.e,At.a,kt.a,I.a,je.b,je.a,r.b],pipes:[i.e,i.f,Ft,Mt,Yt],styles:[".page-action[_ngcontent-%COMP%]{padding-bottom:25px}nz-empty[_ngcontent-%COMP%]{margin-top:50px}.fee-desc[_ngcontent-%COMP%]{white-space:pre}.fee-title[_ngcontent-%COMP%]{margin:5px 0 0!important}nz-table[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]{margin-bottom:0}"]}),e})();var Wt=n("jEv5"),jt=n("KkgV");class Xt{}class Qt{}class Kt{}let en=(()=>{class e{constructor(e){this.http=e,this.API_URL=b.a.apiUrl+"/allowances"}getByMonth(e){return this.http.get(this.API_URL+`/${e}`)}create(e){return this.http.post(this.API_URL,e)}updateByEmployee(e,t,n){return this.http.put(this.API_URL+`/${e}/${t}`,n)}deleteByEmployee(e,t,n){return this.http.delete(this.API_URL+`/${e}/${t}`)}statuses(e,t){return this.http.post(this.API_URL+`/${e}/statuses`,t)}addByEmployee(e,t){return this.http.post(this.API_URL+`/${e}`,t)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(S.c))},e.\u0275prov=c.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function tn(e,t){1&e&&(c.Zb(0,"nz-tag",30),c.Ic(1,"Approved"),c.Yb()),2&e&&c.qc("nzColor","#87d068")}function nn(e,t){if(1&e&&(c.Zb(0,"span"),c.Ic(1,"Have no allowances for "),c.Zb(2,"nz-tag"),c.Ic(3),c.lc(4,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.Jc(c.nc(4,1,e.date,"MM/yyyy"))}}function on(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",34),c.hc("click",(function(){return c.zc(e),c.kc(2).onCreate()})),c.Ic(1,"Create Now"),c.Yb()}if(2&e){const e=c.kc(2);c.qc("disabled",!e.date)("nzLoading",e.isCreating)}}function cn(e,t){if(1&e&&(c.Zb(0,"nz-empty",31),c.Gc(1,nn,5,4,"ng-template",null,32,c.Hc),c.Gc(3,on,2,2,"ng-template",null,33,c.Hc),c.Yb()),2&e){const e=c.yc(2),t=c.yc(4);c.qc("nzNotFoundContent",e)("nzNotFoundFooter",t)}}function sn(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",7),c.hc("click",(function(){return c.zc(e),c.kc(2).approve()})),c.Ub(2,"i",40),c.Ic(3," Approve"),c.Yb(),c.Yb()}}function rn(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",41),c.hc("click",(function(){return c.zc(e),c.kc(2).unapproved()})),c.Ub(2,"i",42),c.Ic(3," Unapproved"),c.Yb(),c.Yb()}}function an(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",22),c.hc("click",(function(){return c.zc(e),c.kc(2).add()})),c.Ub(2,"i",23),c.Yb(),c.Yb()}}function ln(e,t){1&e&&(c.Zb(0,"th"),c.Ic(1,"##"),c.Yb())}function bn(e,t){if(1&e){const e=c.ac();c.Zb(0,"td"),c.Zb(1,"button",46),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc(2).edit(t)})),c.Ub(2,"i",47),c.Yb(),c.Zb(3,"button",48),c.Ub(4,"i",49),c.Yb(),c.Yb()}}function pn(e,t){if(1&e&&(c.Zb(0,"div",50),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit,t=c.kc(2);c.Cb(1),c.Jc(t.getDescription(e.items))}}function dn(e,t){if(1&e&&(c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"a",43),c.Ic(3),c.Yb(),c.Yb(),c.Zb(4,"td"),c.Ic(5),c.Yb(),c.Zb(6,"td"),c.Ic(7),c.lc(8,"number"),c.lc(9,"sumByField"),c.Yb(),c.Zb(10,"td"),c.Ic(11),c.lc(12,"subStr"),c.Ub(13,"i",44),c.Yb(),c.Gc(14,bn,5,0,"td",37),c.Yb(),c.Gc(15,pn,2,1,"ng-template",null,45,c.Hc)),2&e){const e=t.$implicit,n=c.yc(16),i=c.kc(2);c.Cb(2),c.sc("routerLink","/employee/detail/",e.employee.id,""),c.Cb(1),c.Jc(e.employee.email),c.Cb(2),c.Jc(e.employee.fullName),c.Cb(2),c.Kc(" ",c.mc(8,7,c.nc(9,9,e.items,"amount"))," "),c.Cb(4),c.Kc(" ",c.nc(12,12,i.getDescription(e.items),"30")," "),c.Cb(2),c.qc("nzPopoverContent",n),c.Cb(1),c.qc("ngIf",!i.isApproved)}}function hn(e,t){if(1&e&&(c.Zb(0,"div",35),c.Zb(1,"div",18),c.Zb(2,"div",36),c.Zb(3,"nz-space"),c.Gc(4,sn,4,0,"nz-space-item",37),c.Gc(5,rn,4,0,"nz-space-item",37),c.Gc(6,an,3,0,"nz-space-item",37),c.Yb(),c.Yb(),c.Yb(),c.Zb(7,"nz-table",38,39),c.Zb(9,"thead"),c.Zb(10,"tr"),c.Zb(11,"th"),c.Ic(12,"Email"),c.Yb(),c.Zb(13,"th"),c.Ic(14,"Name"),c.Yb(),c.Zb(15,"th"),c.Ic(16,"Total allowance amount"),c.Yb(),c.Zb(17,"th"),c.Ic(18,"Description"),c.Yb(),c.Gc(19,ln,2,0,"th",37),c.Yb(),c.Yb(),c.Zb(20,"tbody"),c.Gc(21,dn,17,15,"ng-template",29),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(8),t=c.kc();c.Cb(4),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",t.isApproved),c.Cb(1),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("nzData",t.listOfData)("nzShowPagination",!1),c.Cb(12),c.qc("ngIf",!t.isApproved),c.Cb(2),c.qc("ngForOf",e.data)}}function un(e,t){if(1&e&&c.Ub(0,"nz-option",51),2&e){const e=t.$implicit;c.qc("nzLabel",e.fullName)("nzValue",e.id)}}function mn(e,t){if(1&e&&(c.Ub(0,"nz-option",51),c.lc(1,"allowanceTypeName")),2&e){const e=t.$implicit;c.qc("nzLabel",c.mc(1,2,e))("nzValue",e)}}function zn(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",56),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc().removeAllowance(t)})),c.Ub(1,"i",49),c.Yb()}}function fn(e,t){if(1&e){const e=c.ac();c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"nz-form-item"),c.Zb(3,"nz-form-control",15),c.Zb(4,"nz-select",52),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateAllowancesData()})),c.Gc(5,mn,2,4,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(6,"td"),c.Zb(7,"nz-form-item"),c.Zb(8,"nz-form-control",15),c.Zb(9,"nz-input-number",53),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateAllowancesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(10,"td"),c.Zb(11,"nz-form-item"),c.Zb(12,"nz-form-control",15),c.Zb(13,"textarea",54),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateAllowancesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(14,"td"),c.Gc(15,zn,2,0,"button",55),c.Yb(),c.Yb()}if(2&e){const e=t.$implicit,n=c.kc();c.Cb(4),c.qc("formControlName","type_"+e.id),c.Cb(1),c.qc("ngForOf",n.allowanceTypes),c.Cb(4),c.qc("formControlName","amount_"+e.id),c.Cb(4),c.qc("formControlName","description_"+e.id),c.Cb(2),c.qc("ngIf",n.currentAllowances.length>1)}}let gn=(()=>{class e{constructor(e,t,n,i,o,c){this.fb=e,this.route=t,this.message=n,this.modal=i,this.allowanceService=o,this.employeeService=c,this.date=new Date,this.isApproved=!1,this.listOfData=[],this.isCreating=!1,this.isCreated=!1,this.isModalVisible=!1,this.allEmployees=[],this.employees=[],this.currentAllowanceId=0,this.allowanceTypes=Object.keys(Wt.a)}ngOnInit(){this.loadAllowance(),this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.currentAllowances=[],this.getEmployee()}onMonthChange(e){this.date=e,this.loadAllowance()}onThisMonth(){this.date=new Date,this.loadAllowance()}onPrevMonth(){this.date=a(this.date).add(-1,"month").toDate(),this.loadAllowance()}onNextMonth(){this.date=a(this.date).add(1,"month").toDate(),this.loadAllowance()}onCreate(){this.isCreating=!0;const e=new Xt;e.month=a(this.date).format("YYYY-MM")+"-01",this.allowanceService.create(e).subscribe(e=>{this.isCreated=!0,this.isCreating=!1,this.listOfData=e.items},e=>{this.isCreating=!1})}approve(){this.modal.confirm({nzTitle:"Do you Want to approve this allowances?",nzContent:"Once you approved, you can still edit it later",nzOnOk:()=>{const e=new u;e.status="APPROVED";const t=a(this.date).format("YYYY-MM");this.allowanceService.statuses(t,e).subscribe(e=>{this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Approve unsuccessfully!")})}})}unapproved(){const e=new u;e.status="UNAPPROVED";const t=a(this.date).format("YYYY-MM");this.allowanceService.statuses(t,e).subscribe(e=>{this.isApproved=!1,this.message.info("Unapproved successfully!")},e=>{this.message.error("Unapproved unsuccessfully!")})}add(){this.employees=this.allEmployees.filter(e=>!this.listOfData.some(t=>t.employee.id===e.id)),this.resetCreateForm(),this.addAllowance(),this.isModalVisible=!0,this.actionType="ADD"}edit(e){this.employees=this.allEmployees.filter(t=>t.id===e.employee.id),this.initCreateForm(e),this.isModalVisible=!0,this.actionType="EDIT"}handleCreateFormOk(){for(const t in this.createForm.controls)this.createForm.controls[t].markAsDirty(),this.createForm.controls[t].updateValueAndValidity();if(this.createForm.invalid)return;const e=a(this.date).format("YYYY-MM");if("ADD"===this.actionType){const t=new Qt;t.employee=new Zt,t.employee.id=this.createForm.get("employeeId").value,t.items=this.currentAllowances,this.allowanceService.addByEmployee(e,t).subscribe(e=>{this.listOfData=e.items,this.message.info("Add successfully!")},e=>{this.message.error("Add unsuccessfully!")})}"EDIT"===this.actionType&&this.allowanceService.updateByEmployee(e,this.currentEmployeeId,this.currentAllowances).subscribe(e=>{this.listOfData=e.items,this.message.info("Update successfully!")},e=>{this.message.error("Update unsuccessfully!")}),this.isModalVisible=!1}handleCreateFormCancel(){this.isModalVisible=!1}addAllowance(){const e=new Kt;e.id=this.currentAllowanceId+"";const t=this.currentAllowances;t.push(e),this.currentAllowances=[...t],this.createForm.addControl("type_"+this.currentAllowanceId,new r.d(null,r.o.required)),this.createForm.addControl("amount_"+this.currentAllowanceId,new r.d(0,r.o.required)),this.createForm.addControl("description_"+this.currentAllowanceId,new r.d(null,r.o.required)),this.currentAllowanceId++}initCreateForm(e){this.createForm=this.fb.group({}),this.currentEmployeeId=e.employee.id,this.createForm.addControl("employeeId",new r.d(e.employee.id,r.o.required));const t=e.items.map(e=>d.a.map(e,new Kt));this.currentAllowances=[...t];for(let i=0;i<t.length;i++){const e=t[i];this.createForm.addControl("type_"+e.id,new r.d(e.type,r.o.required)),this.createForm.addControl("amount_"+e.id,new r.d(e.amount,r.o.required)),this.createForm.addControl("description_"+e.id,new r.d(e.description,r.o.required))}const n=t.map(e=>e.id);this.currentAllowanceId=Math.max.apply(Math,n)+1}removeAllowance(e){this.isModalVisible=!1}updateAllowancesData(){for(const e of this.currentAllowances)e.description=this.createForm.get("description_"+e.id).value,e.amount=this.createForm.get("amount_"+e.id).value,e.type=this.createForm.get("type_"+e.id).value}resetCreateForm(){this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.currentAllowances=[],this.currentAllowanceId=0}getDescription(e){let t="";return e.forEach(e=>{t.length&&(t+="\n"),t+=(new jt.a).transform(e.type),e.description&&(t+=" ("+e.description+")"),t+=": "+e.amount}),t}loadAllowance(){const e=a(this.date).format("YYYY-MM");this.allowanceService.getByMonth(e).subscribe(e=>{this.isCreated=!0,this.isApproved=e.status&&"APPROVED"===e.status,this.listOfData=e.items},e=>{this.isCreated=!1,this.isApproved=!1,this.listOfData=[]})}getEmployee(){this.employeeService.getAll().subscribe(e=>{this.allEmployees=e,this.employees=e})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(r.c),c.Tb(o.c),c.Tb(m.b),c.Tb(z.c),c.Tb(en),c.Tb(Xe.a))},e.\u0275cmp=c.Nb({type:e,selectors:[["app-allowances"]],decls:48,vars:17,consts:[[1,"wrap"],[1,"page-header"],["class","ml-1",3,"nzColor",4,"ngIf"],["nz-button","","nzType","primary","nzShape","circle",3,"click"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-icon","","nzType","arrow-right","nzTheme","outline"],["nzPlaceHolder","Select month",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],[1,"page-content"],[3,"nzNotFoundContent","nzNotFoundFooter",4,"ngIf"],["class","form-wrap",4,"ngIf"],["nzTitle","Add allowances for employees","nzWidth","1000px",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-form","",3,"formGroup"],["nzRequired","","nzFor","employee",3,"nzSm","nzXs"],["nzErrorTip","The input is required!"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a employee","id","employeeId","formControlName","employeeId",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","",1,"page-action"],["nz-col","","nzSpan","19"],["nzOrientation","left","nzText","Fees",1,"fee-title"],["nz-col","","nzSpan","5",1,"text-right"],["nz-button","","nzType","default","nzShape","circle","nz-tooltip","","nzTooltipTitle","Add",3,"click"],["nz-icon","","nzType","plus"],[1,"data-table",3,"nzData","nzFrontPagination"],["createTable",""],["nzWidth","300px"],["nzWidth","200px"],["nzWidth","60px"],["ngFor","",3,"ngForOf"],[1,"ml-1",3,"nzColor"],[3,"nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],[1,"form-wrap"],["nz-col","","nzSpan","24",1,"text-right"],[4,"ngIf"],[1,"data-table",3,"nzData","nzShowPagination"],["basicTable",""],["nz-icon","","nzType","check"],["nz-button","","nzType","default","nzDanger","","nzShape","round",3,"click"],["nz-icon","","nzType","stop"],[3,"routerLink"],["nz-icon","","nzType","info-circle","nzTheme","outline","nz-popover","","nzPopoverTitle","Detail",3,"nzPopoverContent"],["popoverContent",""],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete"],["nz-icon","","nzType","delete"],[1,"allowance-desc"],[3,"nzLabel","nzValue"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a type",2,"width","100%",3,"formControlName","ngModelChange"],["nzPlaceHolder","Amount",2,"width","100%",3,"formControlName","ngModelChange"],["nz-input","","nzAutosize","","placeholder","Description",3,"formControlName","ngModelChange"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click",4,"ngIf"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click"]],template:function(e,t){if(1&e&&(c.Zb(0,"div",0),c.Zb(1,"nz-page-header",1),c.Zb(2,"nz-page-header-title"),c.Ic(3,"Allowances"),c.Yb(),c.Zb(4,"nz-page-header-subtitle"),c.Ic(5),c.lc(6,"date"),c.Gc(7,tn,2,1,"nz-tag",2),c.Yb(),c.Zb(8,"nz-page-header-extra"),c.Zb(9,"button",3),c.hc("click",(function(){return t.onPrevMonth()})),c.Ub(10,"i",4),c.Yb(),c.Zb(11,"button",3),c.hc("click",(function(){return t.onNextMonth()})),c.Ub(12,"i",5),c.Yb(),c.Zb(13,"nz-month-picker",6),c.hc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.onMonthChange(e)})),c.Yb(),c.Zb(14,"button",7),c.hc("click",(function(){return t.onThisMonth()})),c.Ub(15,"i",8),c.Ic(16,"This month "),c.Yb(),c.Yb(),c.Yb(),c.Zb(17,"div",9),c.Gc(18,cn,5,2,"nz-empty",10),c.Gc(19,hn,22,7,"div",11),c.Yb(),c.Yb(),c.Zb(20,"nz-modal",12),c.hc("nzVisibleChange",(function(e){return t.isModalVisible=e}))("nzOnCancel",(function(){return t.handleCreateFormCancel()}))("nzOnOk",(function(){return t.handleCreateFormOk()})),c.Zb(21,"form",13),c.Zb(22,"nz-form-item"),c.Zb(23,"nz-form-label",14),c.Ic(24,"Employee"),c.Yb(),c.Zb(25,"nz-form-control",15),c.Zb(26,"nz-select",16),c.hc("ngModelChange",(function(){return t.updateAllowancesData()})),c.Gc(27,un,1,2,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Zb(28,"div",18),c.Zb(29,"div",19),c.Ub(30,"nz-divider",20),c.Yb(),c.Zb(31,"div",21),c.Zb(32,"button",22),c.hc("click",(function(){return t.addAllowance()})),c.Ub(33,"i",23),c.Yb(),c.Yb(),c.Yb(),c.Zb(34,"nz-table",24,25),c.Zb(36,"thead"),c.Zb(37,"tr"),c.Zb(38,"th",26),c.Ic(39,"Type"),c.Yb(),c.Zb(40,"th",27),c.Ic(41,"Amount"),c.Yb(),c.Zb(42,"th"),c.Ic(43,"Description"),c.Yb(),c.Zb(44,"th",28),c.Ic(45,"##"),c.Yb(),c.Yb(),c.Yb(),c.Zb(46,"tbody"),c.Gc(47,fn,16,5,"ng-template",29),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(35);c.Cb(5),c.Kc("",c.nc(6,14,t.date,"MM/yyyy")," "),c.Cb(2),c.qc("ngIf",t.isApproved),c.Cb(6),c.qc("ngModel",t.date),c.Cb(5),c.qc("ngIf",!t.isCreated),c.Cb(1),c.qc("ngIf",t.isCreated),c.Cb(1),c.qc("nzVisible",t.isModalVisible),c.Cb(1),c.qc("formGroup",t.createForm),c.Cb(2),c.qc("nzSm",6)("nzXs",24),c.Cb(3),c.qc("ngModel",t.currentEmployeeId),c.Cb(1),c.qc("ngForOf",t.employees),c.Cb(7),c.qc("nzData",t.currentAllowances)("nzFrontPagination",!1),c.Cb(13),c.qc("ngForOf",e.data)}},directives:[f.a,f.e,f.d,i.m,f.b,g.a,O.a,D.a,y.b,C.a,C.c,r.k,r.m,z.a,r.p,r.l,Y.b,r.g,q.c,Y.c,q.a,Y.d,Y.a,kt.b,r.f,i.l,wt.a,T.d,k.c,k.g,k.h,k.b,k.f,k.e,v.a,Z.b,R,x,o.e,At.a,kt.a,I.a,je.b,je.a,r.b],pipes:[i.e,i.f,Ft,Mt,jt.a],styles:[".page-action[_ngcontent-%COMP%]{padding-bottom:25px}nz-empty[_ngcontent-%COMP%]{margin-top:50px}.allowance-desc[_ngcontent-%COMP%]{white-space:pre}"]}),e})();class yn{}var Cn=function(e){return e.PERFORMANCE="PERFORMANCE",e.PROJECT="PROJECT",e.VACATION="VACATION",e.OTHER="OTHER",e}({});class Yn{}let In=(()=>{class e{transform(e){if(!e)return"";switch(e){case Cn.PERFORMANCE:return"Performance";case Cn.PROJECT:return"Project";case Cn.VACATION:return"Vacation";case Cn.OTHER:default:return"Other"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Sb({name:"bonusTypeName",type:e,pure:!0}),e})(),vn=(()=>{class e{constructor(e){this.http=e,this.API_URL=b.a.apiUrl+"/bonuses"}getByMonth(e){return this.http.get(this.API_URL+`/${e}`)}create(e){return this.http.post(this.API_URL,e)}updateByEmployee(e,t,n){return this.http.put(this.API_URL+`/${e}/${t}`,n)}deleteByEmployee(e,t,n){return this.http.delete(this.API_URL+`/${e}/${t}`)}statuses(e,t){return this.http.post(this.API_URL+`/${e}/statuses`,t)}addByEmployee(e,t){return this.http.post(this.API_URL+`/${e}`,t)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(S.c))},e.\u0275prov=c.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Zn(e,t){1&e&&(c.Zb(0,"nz-tag",30),c.Ic(1,"Approved"),c.Yb()),2&e&&c.qc("nzColor","#87d068")}function Tn(e,t){if(1&e&&(c.Zb(0,"span"),c.Ic(1,"Have no bonus for "),c.Zb(2,"nz-tag"),c.Ic(3),c.lc(4,"date"),c.Yb(),c.Yb()),2&e){const e=c.kc(2);c.Cb(3),c.Jc(c.nc(4,1,e.date,"MM/yyyy"))}}function kn(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space"),c.Zb(1,"nz-space-item"),c.Zb(2,"button",34),c.hc("click",(function(){return c.zc(e),c.kc(2).add()})),c.Ic(3,"Create Now"),c.Yb(),c.Yb(),c.Zb(4,"nz-space-item"),c.Zb(5,"button",35),c.hc("click",(function(){return c.zc(e),c.kc(2).onEmptyApprove()})),c.Ic(6,"Approve with empty bonuse"),c.Yb(),c.Yb(),c.Yb()}if(2&e){const e=c.kc(2);c.Cb(2),c.qc("disabled",!e.date),c.Cb(3),c.qc("disabled",!e.date)("nzLoading",e.isApproving)}}function wn(e,t){if(1&e&&(c.Zb(0,"nz-empty",31),c.Gc(1,Tn,5,4,"ng-template",null,32,c.Hc),c.Gc(3,kn,7,3,"ng-template",null,33,c.Hc),c.Yb()),2&e){const e=c.yc(2),t=c.yc(4);c.qc("nzNotFoundContent",e)("nzNotFoundFooter",t)}}function An(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",7),c.hc("click",(function(){return c.zc(e),c.kc(2).approve()})),c.Ub(2,"i",41),c.Ic(3," Approve"),c.Yb(),c.Yb()}}function Sn(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",42),c.hc("click",(function(){return c.zc(e),c.kc(2).unapproved()})),c.Ub(2,"i",43),c.Ic(3," Unapproved"),c.Yb(),c.Yb()}}function Fn(e,t){if(1&e){const e=c.ac();c.Zb(0,"nz-space-item"),c.Zb(1,"button",22),c.hc("click",(function(){return c.zc(e),c.kc(2).add()})),c.Ub(2,"i",23),c.Yb(),c.Yb()}}function Mn(e,t){1&e&&(c.Zb(0,"th"),c.Ic(1,"##"),c.Yb())}function On(e,t){if(1&e){const e=c.ac();c.Zb(0,"td"),c.Zb(1,"button",47),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc(2).edit(t)})),c.Ub(2,"i",48),c.Yb(),c.Zb(3,"button",49),c.Ub(4,"i",50),c.Yb(),c.Yb()}}function Dn(e,t){if(1&e&&(c.Zb(0,"div",51),c.Ic(1),c.Yb()),2&e){const e=c.kc().$implicit,t=c.kc(2);c.Cb(1),c.Jc(t.getDescription(e.items))}}function qn(e,t){if(1&e&&(c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"a",44),c.Ic(3),c.Yb(),c.Yb(),c.Zb(4,"td"),c.Ic(5),c.Yb(),c.Zb(6,"td"),c.Ic(7),c.lc(8,"number"),c.lc(9,"sumByField"),c.Yb(),c.Zb(10,"td"),c.Ic(11),c.lc(12,"subStr"),c.Ub(13,"i",45),c.Yb(),c.Gc(14,On,5,0,"td",38),c.Yb(),c.Gc(15,Dn,2,1,"ng-template",null,46,c.Hc)),2&e){const e=t.$implicit,n=c.yc(16),i=c.kc(2);c.Cb(2),c.sc("routerLink","/employee/detail/",e.employee.id,""),c.Cb(1),c.Jc(e.employee.email),c.Cb(2),c.Jc(e.employee.fullName),c.Cb(2),c.Jc(c.mc(8,7,c.nc(9,9,e.items,"amount"))),c.Cb(4),c.Kc(" ",c.nc(12,12,i.getDescription(e.items),"30")," "),c.Cb(2),c.qc("nzPopoverContent",n),c.Cb(1),c.qc("ngIf",!i.isApproved)}}function Pn(e,t){if(1&e&&(c.Zb(0,"div",36),c.Zb(1,"div",18),c.Zb(2,"div",37),c.Zb(3,"nz-space"),c.Gc(4,An,4,0,"nz-space-item",38),c.Gc(5,Sn,4,0,"nz-space-item",38),c.Gc(6,Fn,3,0,"nz-space-item",38),c.Yb(),c.Yb(),c.Yb(),c.Zb(7,"nz-table",39,40),c.Zb(9,"thead"),c.Zb(10,"tr"),c.Zb(11,"th"),c.Ic(12,"Email"),c.Yb(),c.Zb(13,"th"),c.Ic(14,"Name"),c.Yb(),c.Zb(15,"th"),c.Ic(16,"Total bonues amount"),c.Yb(),c.Zb(17,"th"),c.Ic(18,"Detail"),c.Yb(),c.Gc(19,Mn,2,0,"th",38),c.Yb(),c.Yb(),c.Zb(20,"tbody"),c.Gc(21,qn,17,15,"ng-template",29),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(8),t=c.kc();c.Cb(4),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("ngIf",t.isApproved),c.Cb(1),c.qc("ngIf",!t.isApproved),c.Cb(1),c.qc("nzData",t.listOfData)("nzShowPagination",!1),c.Cb(12),c.qc("ngIf",!t.isApproved),c.Cb(2),c.qc("ngForOf",e.data)}}function Un(e,t){if(1&e&&c.Ub(0,"nz-option",52),2&e){const e=t.$implicit;c.qc("nzLabel",e.fullName)("nzValue",e.id)}}function En(e,t){if(1&e&&(c.Ub(0,"nz-option",52),c.lc(1,"bonusTypeName")),2&e){const e=t.$implicit;c.qc("nzLabel",c.mc(1,2,e))("nzValue",e)}}function _n(e,t){if(1&e){const e=c.ac();c.Zb(0,"button",57),c.hc("click",(function(){c.zc(e);const t=c.kc().$implicit;return c.kc().removeBonus(t)})),c.Ub(1,"i",50),c.Yb()}}function Nn(e,t){if(1&e){const e=c.ac();c.Zb(0,"tr"),c.Zb(1,"td"),c.Zb(2,"nz-form-item"),c.Zb(3,"nz-form-control",15),c.Zb(4,"nz-select",53),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateBonusesData()})),c.Gc(5,En,2,4,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(6,"td"),c.Zb(7,"nz-form-item"),c.Zb(8,"nz-form-control",15),c.Zb(9,"nz-input-number",54),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateBonusesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(10,"td"),c.Zb(11,"nz-form-item"),c.Zb(12,"nz-form-control",15),c.Zb(13,"textarea",55),c.hc("ngModelChange",(function(){return c.zc(e),c.kc().updateBonusesData()})),c.Yb(),c.Yb(),c.Yb(),c.Yb(),c.Zb(14,"td"),c.Gc(15,_n,2,0,"button",56),c.Yb(),c.Yb()}if(2&e){const e=t.$implicit,n=c.kc();c.Cb(4),c.qc("formControlName","type_"+e.id),c.Cb(1),c.qc("ngForOf",n.bonusTypes),c.Cb(4),c.qc("formControlName","amount_"+e.id),c.Cb(4),c.qc("formControlName","description_"+e.id),c.Cb(2),c.qc("ngIf",n.newBonuses.length>1)}}const Gn=[{path:"",component:s,children:[{path:"payroll",component:Ct},{path:"timesheet",component:ue},{path:"allowances",component:gn},{path:"bonus",component:(()=>{class e{constructor(e,t,n,i,o,c){this.fb=e,this.route=t,this.message=n,this.modal=i,this.employeeService=o,this.bonusService=c,this.date=new Date,this.isApproved=!1,this.listOfData=[],this.isModalVisible=!1,this.isCreated=!1,this.isApproving=!1,this.currentBonusId=0,this.bonusTypes=Object.keys(Cn),this.allEmployees=[],this.employees=[]}ngOnInit(){this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.newBonuses=[],this.getEmployee(),this.loadBonus()}onMonthChange(e){this.date=e,this.loadBonus()}onThisMonth(){this.date=new Date,this.loadBonus()}onPrevMonth(){this.date=a(this.date).add(-1,"month").toDate(),this.loadBonus()}onNextMonth(){this.date=a(this.date).add(1,"month").toDate(),this.loadBonus()}onEmptyApprove(){const e=new Tt;e.month=a(this.date).format("YYYY-MM")+"-01",e.isApprove=!0,this.bonusService.create(e).subscribe(e=>{this.isCreated=!0,this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Unapproved successfully!")})}handleCreateFormOk(){for(const t in this.createForm.controls)this.createForm.controls[t].markAsDirty(),this.createForm.controls[t].updateValueAndValidity();if(this.createForm.invalid)return;const e=a(this.date).format("YYYY-MM");if("ADD"===this.actionType){const t=new Yn;t.employee=new Zt,t.employee.id=this.createForm.get("employeeId").value,t.items=this.newBonuses,t.createIfNotExist=!0,this.bonusService.addByEmployee(e,t).subscribe(e=>{this.listOfData=e.items,this.isCreated=!0,this.message.info("Add successfully!")},e=>{this.message.error("Add unsuccessfully!")})}"EDIT"===this.actionType&&this.bonusService.updateByEmployee(e,this.currentEmployeeId,this.newBonuses).subscribe(e=>{this.listOfData=e.items,this.message.info("Update successfully!")},e=>{this.message.error("Update unsuccessfully!")}),this.isModalVisible=!1}handleCreateFormCancel(){this.isModalVisible=!1,this.resetCreateForm()}approve(){this.modal.confirm({nzTitle:"Do you Want to approve this bonuss?",nzContent:"Once you approved, you can still edit it later",nzOnOk:()=>{const e=new u;e.status="APPROVED";const t=a(this.date).format("YYYY-MM");this.bonusService.statuses(t,e).subscribe(e=>{this.isApproved=!0,this.message.info("Approve successfully!")},e=>{this.message.error("Approve unsuccessfully!")})}})}unapproved(){const e=new u;e.status="UNAPPROVED";const t=a(this.date).format("YYYY-MM");this.bonusService.statuses(t,e).subscribe(e=>{this.isApproved=!1,this.message.info("Unapproved successfully!")},e=>{this.message.error("Unapproved unsuccessfully!")})}add(){this.employees=this.allEmployees.filter(e=>!this.listOfData.some(t=>t.employee.id===e.id)),this.resetCreateForm(),this.addBonus(),this.isModalVisible=!0,this.actionType="ADD"}edit(e){this.employees=this.allEmployees.filter(t=>t.id===e.employee.id),this.initCreateForm(e),this.isModalVisible=!0,this.actionType="EDIT"}addBonus(){const e=new yn;e.id=this.currentBonusId+"";const t=this.newBonuses;t.push(e),this.newBonuses=[...t],this.createForm.addControl("type_"+this.currentBonusId,new r.d(null,r.o.required)),this.createForm.addControl("amount_"+this.currentBonusId,new r.d(0,r.o.required)),this.createForm.addControl("description_"+this.currentBonusId,new r.d(null,r.o.required)),this.currentBonusId++}removeBonus(e){this.createForm.removeControl("type_"+e.id),this.createForm.removeControl("amount_"+e.id),this.createForm.removeControl("description_"+e.id),this.newBonuses=this.newBonuses.filter(t=>t.id!==e.id)}updateBonusesData(){for(const e of this.newBonuses)e.description=this.createForm.get("description_"+e.id).value,e.amount=this.createForm.get("amount_"+e.id).value,e.type=this.createForm.get("type_"+e.id).value}resetCreateForm(){this.createForm=this.fb.group({employeeId:[null,[r.o.required]]}),this.newBonuses=[],this.currentBonusId=0}initCreateForm(e){this.createForm=this.fb.group({});const t=e.items.map(e=>d.a.map(e,new Yn));this.newBonuses=[...t],this.currentEmployeeId=e.employee.id,this.createForm.addControl("employeeId",new r.d(e.employee.id,r.o.required));for(let i=0;i<t.length;i++){const e=t[i];this.createForm.addControl("type_"+e.id,new r.d(e.type,r.o.required)),this.createForm.addControl("amount_"+e.id,new r.d(e.amount,r.o.required)),this.createForm.addControl("description_"+e.id,new r.d(e.description))}const n=t.map(e=>e.id);this.currentBonusId=Math.max.apply(Math,n)+1}getDescription(e){let t="";return e.forEach(e=>{t.length&&(t+="\n"),t+=(new In).transform(e.type),e.description&&(t+=" ("+e.description+")"),t+=": "+e.amount}),t}loadBonus(){const e=a(this.date).format("YYYY-MM");this.bonusService.getByMonth(e).subscribe(e=>{this.isCreated=!0,this.isApproved=e.status&&"APPROVED"===e.status,this.listOfData=e.items},e=>{this.isCreated=!1,this.isApproved=!1,this.listOfData=[]})}getEmployee(){this.employeeService.getAll().subscribe(e=>{this.allEmployees=e,this.employees=e})}}return e.\u0275fac=function(t){return new(t||e)(c.Tb(r.c),c.Tb(o.c),c.Tb(m.b),c.Tb(z.c),c.Tb(Xe.a),c.Tb(vn))},e.\u0275cmp=c.Nb({type:e,selectors:[["app-bonus"]],decls:48,vars:17,consts:[[1,"wrap"],[1,"page-header"],["class","ml-1",3,"nzColor",4,"ngIf"],["nz-button","","nzType","primary","nzShape","circle",3,"click"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-icon","","nzType","arrow-right","nzTheme","outline"],["nzPlaceHolder","Select month",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],[1,"page-content"],[3,"nzNotFoundContent","nzNotFoundFooter",4,"ngIf"],["class","form-wrap",4,"ngIf"],["nzTitle","Add bonuses for employees","nzWidth","1000px",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-form","",3,"formGroup"],["nzRequired","","nzFor","employee",3,"nzSm","nzXs"],["nzErrorTip","The input is required!"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a employee","id","employee","formControlName","employeeId",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","",1,"page-action"],["nz-col","","nzSpan","19"],["nzOrientation","left","nzText","Bonuses",1,"bonuses-title"],["nz-col","","nzSpan","5",1,"text-right"],["nz-button","","nzType","default","nzShape","circle","nz-tooltip","","nzTooltipTitle","Add",3,"click"],["nz-icon","","nzType","plus"],[1,"data-table",3,"nzData","nzFrontPagination"],["createTable",""],["nzWidth","300px"],["nzWidth","200px"],["nzWidth","60px"],["ngFor","",3,"ngForOf"],[1,"ml-1",3,"nzColor"],[3,"nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["nz-button","","nzType","primary",3,"disabled","click"],["nz-button","","nzType","dashed",3,"disabled","nzLoading","click"],[1,"form-wrap"],["nz-col","","nzSpan","24",1,"text-right"],[4,"ngIf"],[1,"data-table",3,"nzData","nzShowPagination"],["basicTable",""],["nz-icon","","nzType","check"],["nz-button","","nzType","default","nzDanger","","nzShape","round",3,"click"],["nz-icon","","nzType","stop"],[3,"routerLink"],["nz-icon","","nzType","info-circle","nzTheme","outline","nz-popover","","nzPopoverTitle","Detail",3,"nzPopoverContent"],["popoverContent",""],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete"],["nz-icon","","nzType","delete"],[1,"bonuse-desc"],[3,"nzLabel","nzValue"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a type",2,"width","100%",3,"formControlName","ngModelChange"],["nzPlaceHolder","Amount",2,"width","100%",3,"formControlName","ngModelChange"],["nz-input","","nzAutosize","","placeholder","Description",3,"formControlName","ngModelChange"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click",4,"ngIf"],["nz-button","","nzType","link","nzSize","small","nzShape","circle","nzDanger","","nz-tooltip","","nzTooltipTitle","Delete",3,"click"]],template:function(e,t){if(1&e&&(c.Zb(0,"div",0),c.Zb(1,"nz-page-header",1),c.Zb(2,"nz-page-header-title"),c.Ic(3,"Bonuses"),c.Yb(),c.Zb(4,"nz-page-header-subtitle"),c.Ic(5),c.lc(6,"date"),c.Gc(7,Zn,2,1,"nz-tag",2),c.Yb(),c.Zb(8,"nz-page-header-extra"),c.Zb(9,"button",3),c.hc("click",(function(){return t.onPrevMonth()})),c.Ub(10,"i",4),c.Yb(),c.Zb(11,"button",3),c.hc("click",(function(){return t.onNextMonth()})),c.Ub(12,"i",5),c.Yb(),c.Zb(13,"nz-month-picker",6),c.hc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.onMonthChange(e)})),c.Yb(),c.Zb(14,"button",7),c.hc("click",(function(){return t.onThisMonth()})),c.Ub(15,"i",8),c.Ic(16,"This month "),c.Yb(),c.Yb(),c.Yb(),c.Zb(17,"div",9),c.Gc(18,wn,5,2,"nz-empty",10),c.Gc(19,Pn,22,7,"div",11),c.Yb(),c.Yb(),c.Zb(20,"nz-modal",12),c.hc("nzVisibleChange",(function(e){return t.isModalVisible=e}))("nzOnCancel",(function(){return t.handleCreateFormCancel()}))("nzOnOk",(function(){return t.handleCreateFormOk()})),c.Zb(21,"form",13),c.Zb(22,"nz-form-item"),c.Zb(23,"nz-form-label",14),c.Ic(24,"Employee"),c.Yb(),c.Zb(25,"nz-form-control",15),c.Zb(26,"nz-select",16),c.hc("ngModelChange",(function(){return t.updateBonusesData()})),c.Gc(27,Un,1,2,"nz-option",17),c.Yb(),c.Yb(),c.Yb(),c.Zb(28,"div",18),c.Zb(29,"div",19),c.Ub(30,"nz-divider",20),c.Yb(),c.Zb(31,"div",21),c.Zb(32,"button",22),c.hc("click",(function(){return t.addBonus()})),c.Ub(33,"i",23),c.Yb(),c.Yb(),c.Yb(),c.Zb(34,"nz-table",24,25),c.Zb(36,"thead"),c.Zb(37,"tr"),c.Zb(38,"th",26),c.Ic(39,"Type"),c.Yb(),c.Zb(40,"th",27),c.Ic(41,"Amount"),c.Yb(),c.Zb(42,"th"),c.Ic(43,"Description"),c.Yb(),c.Zb(44,"th",28),c.Ic(45,"##"),c.Yb(),c.Yb(),c.Yb(),c.Zb(46,"tbody"),c.Gc(47,Nn,16,5,"ng-template",29),c.Yb(),c.Yb(),c.Yb(),c.Yb()),2&e){const e=c.yc(35);c.Cb(5),c.Kc("",c.nc(6,14,t.date,"MM/yyyy")," "),c.Cb(2),c.qc("ngIf",t.isApproved),c.Cb(6),c.qc("ngModel",t.date),c.Cb(5),c.qc("ngIf",!t.isCreated),c.Cb(1),c.qc("ngIf",t.isCreated),c.Cb(1),c.qc("nzVisible",t.isModalVisible),c.Cb(1),c.qc("formGroup",t.createForm),c.Cb(2),c.qc("nzSm",6)("nzXs",24),c.Cb(3),c.qc("ngModel",t.currentEmployeeId),c.Cb(1),c.qc("ngForOf",t.employees),c.Cb(7),c.qc("nzData",t.newBonuses)("nzFrontPagination",!1),c.Cb(13),c.qc("ngForOf",e.data)}},directives:[f.a,f.e,f.d,i.m,f.b,g.a,O.a,D.a,y.b,C.a,C.c,r.k,r.m,z.a,r.p,r.l,Y.b,r.g,q.c,Y.c,q.a,Y.d,Y.a,kt.b,r.f,i.l,wt.a,T.d,k.c,k.g,k.h,k.b,k.f,k.e,v.a,Z.b,R,x,o.e,At.a,kt.a,I.a,je.b,je.a,r.b],pipes:[i.e,i.f,Ft,Mt,In],styles:[".page-action[_ngcontent-%COMP%]{padding-bottom:25px}nz-empty[_ngcontent-%COMP%]{margin-top:50px}.bonus-desc[_ngcontent-%COMP%]{white-space:pre}.bonus-title[_ngcontent-%COMP%]{margin:5px 0 0!important}nz-table[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]{margin-bottom:0}"]}),e})()},{path:"fees",component:Jt}]}];let Vn=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[o.f.forChild(Gn)],o.f]}),e})();var xn=n("PCNd"),Rn=n("3/1E"),Bn=n("F6ss"),Ln=n("OEtX"),$n=(n("l5mm"),n("BSwL"));let Hn=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[i.c,Me.b,ge.a,$n.a]]}),e})(),Jn=(()=>{class e{}return e.\u0275mod=c.Rb({type:e}),e.\u0275inj=c.Qb({factory:function(t){return new(t||e)},imports:[[i.c,Vn,r.h,xn.a,r.n,f.c,k.d,Rn.b,g.c,y.c,Y.e,je.d,q.b,kt.c,T.b,w.b,z.b,Bn.a,v.b,C.b,Ln.c,I.b,wt.b,m.a,Z.c,z.b,A.b,Hn,B,At.b,We,Fe]]}),e})()}}]);